<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>闪阳的web之旅</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="闪阳的web之旅">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="闪阳的web之旅">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="闪阳的web之旅">
  
    <link rel="alternate" href="/atom.xml" title="闪阳的web之旅" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">闪阳的web之旅</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">科技并不仅限于计算机，任何可以使事情更易完成的方法都是科技。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-JavaScript/functional programming/purity" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/27/JavaScript/functional programming/purity/" class="article-date">
  <time datetime="2016-10-27T11:42:28.462Z" itemprop="datePublished">2016-10-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/27/JavaScript/functional programming/purity/">纯度</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="纯函数坚持一下属性"><a href="#纯函数坚持一下属性" class="headerlink" title="纯函数坚持一下属性"></a>纯函数坚持一下属性</h5><ol>
<li>其结果只能从它的参数的值来计算。</li>
<li>不能依赖于能被外部操作改变的数据。</li>
<li>不能改变外部状态</li>
</ol>
<p>违反了纯度的第一条规则，因为的计算没有使用任何参数。<br>同事，也违反了第二条规则，因为它的结果是完全依赖于JavaScript的随机数生成器，这相当于从一个黑箱子中拿出完全跟输入参数无关的值。<br>这是语言级别上而不是随机生成器的问题。也就是说，你可以通过依赖调用者提供的“种子”值，创建一个纯粹的随机数生成器。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> rand = partial(_.random, <span class="number">1</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">randString</span>(<span class="params">len</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> ascii = repeatedly(len, partial(rand, <span class="number">35</span>));</div><div class="line"></div><div class="line">    <span class="keyword">return</span> _.map(ascii, <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> n.toString(<span class="number">36</span>);</div><div class="line">    &#125;).join(<span class="string">''</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>打破第一条规则的另一个例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">PI = <span class="number">3.14</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">areaOfACircle</span>(<span class="params">radius</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> PI * sqr(radius);</div><div class="line">&#125;</div><div class="line">areaOfACircle(<span class="number">3</span>);</div><div class="line"><span class="comment">//=&gt; 28.26</span></div><div class="line"></div><div class="line">PI = <span class="string">"Magnum"</span>;</div><div class="line">areaOfACircle(<span class="number">3</span>);</div><div class="line"><span class="comment">//=&gt; NaN</span></div></pre></td></tr></table></figure>
<p><strong>提取纯函数</strong></p>
<p>因为JavaScript的Math.rand方法从设计上讲都是不纯的，任何使用它的函数都将变成非纯函数，因此难以测试。纯函数可以通过建立一组输入值和输出的数据进行测试。JavaScript中海油一些会导致不纯的函数或方法如Date.now, console.log, this和全局变量。事实上，因为JavaScript可以传递对象的引用，所以每一个接受对象或者数据的函数都有可能不纯。虽然JavaScript是不可能完全纯净的(可能我们也不希望这样)，但我们可以将变化的影响降到最低限度。</p>
<h5 id="不变性"><a href="#不变性" class="headerlink" title="不变性"></a>不变性</h5><p><strong>如果一颗树倒在树林里，有没有声音</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">skipTake</span>(<span class="params">n, coll</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> ret = [];</div><div class="line">    <span class="keyword">var</span> sz = _.size(coll);</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; sz; index += n)&#123;</div><div class="line">        ret.push(coll[index]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"></div><div class="line">skipTake(<span class="number">2</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]);</div><div class="line"><span class="comment">//=&gt; [1, 3]</span></div><div class="line"></div><div class="line">skipTake(<span class="number">3</span>,_.range(<span class="number">20</span>));</div><div class="line"><span class="comment">//=&gt; [0, 3, 6, 9, 12, 15, 18]</span></div></pre></td></tr></table></figure>
<p><strong>不变性与递归</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">summ</span>(<span class="params">array</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> result = <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> sz = array.length;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; sz; i++)&#123;</div><div class="line">        result += array[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该函数summ要改变两个局部变量： i和result。然而，在传统的函数语言中，局部变量实际上不是变量，是不可变的。唯一修改局部变量值得方法是通过调用堆桟去改变它，而这正是递归。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">summRec</span>(<span class="params">array, seed</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(_.isEmpty(array))&#123;</div><div class="line">        <span class="keyword">return</span> seed;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> summRec(_.rest(array), _.first(array) + seed);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>冻结和克隆</strong></p>
<p>Object.freeze 浅克隆</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line">a[<span class="number">1</span>]=<span class="number">42</span>;</div><div class="line"><span class="comment">//=&gt; [1, 42, 3]</span></div><div class="line"><span class="built_in">Object</span>.freeze(a);</div><div class="line">a[<span class="number">1</span>]=<span class="number">108</span></div><div class="line"><span class="comment">//=&gt; [1, 42, 3]</span></div><div class="line"><span class="built_in">Object</span>.isFrozen(a);</div><div class="line"><span class="comment">//=&gt; true</span></div></pre></td></tr></table></figure>
<p><strong>深克隆</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepFreeze</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!<span class="built_in">Object</span>.isFrozen(obj))&#123;</div><div class="line">        <span class="built_in">Object</span>.freeze(obj);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> obj)&#123;</div><div class="line">        <span class="keyword">if</span>(!obj.hasOwnProperty(key) || !_.isObject(obj[key])) <span class="keyword">continue</span>;</div><div class="line"></div><div class="line">        deepFreeze(obj[key]);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>使用_.clone，如果你知道一个浅克隆就足够了</li>
<li>使用deepClone拷贝整套副本</li>
<li>将你的代码建立在纯函数之上</li>
</ol>
<p><strong>在函数级别上观察不变性</strong></p>
<p>他们接收集合并从它建立另一个集合。<br>注意观战纯函数实现有助于消除函数组合出来新的行为正确与否的担忧。如果你组合纯函数，结果也是纯函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> freq = curry2(_.countBy)(_.identity);</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = repeatedly(<span class="number">1000</span>,partial(rand, <span class="number">2</span>));</div><div class="line"><span class="keyword">var</span> copy = _.clone(a);</div><div class="line"></div><div class="line">freq(a);</div><div class="line"><span class="comment">//=&gt; &#123;1: 490, 2: 510&#125;</span></div><div class="line">_.isEqual(a, copy);</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line"></div><div class="line">freq(skipTake(<span class="number">2</span>,a));</div><div class="line"><span class="comment">//=&gt; &#123;1: 243, 2: 257&#125;</span></div><div class="line">_.isEqual(a, copy);</div><div class="line"><span class="comment">//=&gt; true</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person = &#123;fname: <span class="string">"Simon"</span>&#125;;</div><div class="line"></div><div class="line">_.extend(person, &#123;lname: <span class="string">"Pertrikov"</span>&#125;, &#123;age: <span class="number">28</span>&#125;, &#123;age: <span class="number">108</span>&#125;);</div><div class="line"><span class="comment">//=&gt; &#123;fname: "Simon", lname: "Pertrikov", age: 108&#125;</span></div><div class="line"></div><div class="line">person;</div><div class="line"><span class="comment">//=&gt; &#123;fname: "Simon", lname: "Pertrikov", age: 108&#125;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params"><span class="comment">/*args*/</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.extend.apply(<span class="literal">null</span>, construct(&#123;&#125;, <span class="built_in">arguments</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> person = &#123;fname: <span class="string">"Simon"</span>&#125;;</div><div class="line"></div><div class="line">merge(person, &#123;lname: <span class="string">"Pertrikov"</span>&#125;, &#123;age: <span class="number">28</span>&#125;, &#123;age: <span class="number">108</span>&#125;);</div><div class="line"><span class="comment">//=&gt; &#123;fname: "Simon", lname: "Pertrikov", age: 108&#125;</span></div><div class="line"></div><div class="line">person;</div><div class="line"><span class="comment">//=&gt; &#123;fname: "Simon"&#125;</span></div></pre></td></tr></table></figure>
<p><strong>观察对象的不变性</strong></p>
<blockquote>
<p>对于JavaScript的内置类型和对象，你很难做到普通的不变性，除非普通使用冻结或严格使用规范。</p>
</blockquote>
<ol>
<li>不可变对象应该在构造时固定他们的值而之后再不能修改</li>
<li>不可变对象操作并返回新对象</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span>(<span class="params">x, y</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>._x = x;</div><div class="line">    <span class="keyword">this</span>._y = y;</div><div class="line">&#125;</div><div class="line">Point.prototype = &#123;</div><div class="line">    withX: <span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Point(val, <span class="keyword">this</span>._y);</div><div class="line">    &#125;,</div><div class="line">    withY: <span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Point(<span class="keyword">this</span>._x, val);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Point(<span class="number">0</span>,<span class="number">1</span>);</div><div class="line"></div><div class="line">p.withX(<span class="number">1000</span>);</div><div class="line"><span class="comment">//=&gt; &#123;_x: 1000, _y: 1&#125;</span></div><div class="line">p;</div><div class="line"><span class="comment">//=&gt; &#123;_x: 0, _y: 1&#125;</span></div><div class="line"></div><div class="line">(<span class="keyword">new</span> Point(<span class="number">0</span>, <span class="number">1</span>).withX(<span class="number">100</span>).withY(<span class="number">-100</span>));</div><div class="line"><span class="comment">//=&gt; &#123;_x: 100, _y: -100&#125;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> seed = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> q = <span class="keyword">new</span> Queue(seed);</div><div class="line"><span class="keyword">var</span> q2 = q.enqueue(<span class="number">108</span>);</div><div class="line">seed;</div><div class="line"><span class="comment">// [1, 2, 3, 108]</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> SaferQueue = <span class="function"><span class="keyword">function</span> (<span class="params">elems</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>._q = _.clone(elems);</div><div class="line">&#125;</div><div class="line">SaferQueue.prototype = &#123;</div><div class="line">    enqueue: <span class="function"><span class="keyword">function</span> (<span class="params">thing</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SaferQueue(cat(<span class="keyword">this</span>._q, [thing]));</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> seed = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> q = <span class="keyword">new</span> SaferQueue(seed);</div><div class="line"><span class="keyword">var</span> q2 = q.enqueue(<span class="number">36</span>);</div></pre></td></tr></table></figure>
<blockquote>
<p>每个q实例都有一个公共字段_q，我可以很容易地直接修改它们。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">q._q.push(<span class="number">-1111</span>);</div><div class="line">q._q;</div><div class="line"><span class="comment">//=&gt; [1, 2, 3, -1111]</span></div></pre></td></tr></table></figure>
<blockquote>
<p>同样，我可以很容易地替换SaferQueue.prototype中的方法来做我想做的事情</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SaferQueue.prototype.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> []&#125;;</div></pre></td></tr></table></figure>
<p>JavaScript只能提供这么多的安全了，因此，责任在于我们要坚持变成规范，以确保我们的变成实践是尽可能安全的。</p>
<p><strong>对象往往是一个低级别的操作</strong></p>
<p>不适用new 使用构造函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var SaferQueue = function (elems) &#123;</div><div class="line">    this._q = _.clone(elems);</div><div class="line">&#125;</div><div class="line">SaferQueue.prototype = &#123;</div><div class="line">    enqueue: function (thing) &#123;</div><div class="line">        return new SaferQueue(cat(this._q, [thing]));</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">function queue()&#123;</div><div class="line">    return new SaferQueue(_.toArray(arguments));</div><div class="line">&#125;</div><div class="line"></div><div class="line">var q = queue(1,2,3);</div><div class="line"></div><div class="line">var enqueue = invoker(&apos;enqueue&apos;,SaferQueue.prototype.enqueue);</div><div class="line">enqueue(q, 42)</div><div class="line">//=&gt; [1, 2, 3, 42]</div></pre></td></tr></table></figure></p>
<p>使用函数而不是裸的方法调用给了我很大的灵活性，包括但不限于以下内容。</p>
<ol>
<li>我不需要过分担心实际的类型</li>
<li>我可以返回适合特定用例的类型。例如，小的数据在建模小map时相当快，但作为map增长，用一个对象可能更合适。这种切换可以根据程序中的使用出现。</li>
<li>如果类型或方法改变，那么我只需要更改函数，而不是每一个使用的地方。</li>
<li>该函数可组合。</li>
</ol>
<p>以这种方式使用的函数并不是告别面向对象编程（实际上，他们是互补的）。相反，它推动你进入视线细节领域。这使你和用户都工作在函数式的抽象，同时允许实施者集中于改变底层机制而不破坏现有代码。</p>
<h5 id="控制变化的政策"><a href="#控制变化的政策" class="headerlink" title="控制变化的政策"></a>控制变化的政策</h5><p>突变的网络，任何潜在的变化对全局的影响<br>如果你绝对需要管理状态，那么理想的情况是将它隔离到一个地方</p>
<p>本节是关于隔离变化到单个点并实现需要保持状态的折中侧罗。控制变化的范围的方法是隔离可变的东西。也就是说，比起随便拿到一个对象并改变它，更好的策略是把对象放入容器中，并更改该容器。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> container = contain(&#123;name： <span class="string">"Lemonjon"</span>&#125;);</div><div class="line">container.set(&#123;name: <span class="string">"Lemongrab"</span>&#125;);</div><div class="line"><span class="comment">//对比</span></div><div class="line"><span class="keyword">var</span> bing = &#123;name: <span class="string">"Lemonjon"</span>&#125;;</div><div class="line">being.name = <span class="string">"Lemongrab"</span>;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/27/JavaScript/functional programming/purity/" data-id="ciurq4ci90000w0nis6kz37ey" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/function/">function</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/functional programming/recursion" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/25/JavaScript/functional programming/recursion/" class="article-date">
  <time datetime="2016-10-25T05:17:02.445Z" itemprop="datePublished">2016-10-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/25/JavaScript/functional programming/recursion/">递归</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="理解递归对理解函数式编程来说非常重要，原因有三"><a href="#理解递归对理解函数式编程来说非常重要，原因有三" class="headerlink" title="理解递归对理解函数式编程来说非常重要，原因有三"></a>理解递归对理解函数式编程来说非常重要，原因有三</h5><ul>
<li>递归的解决方案包括使用对一个普通问题子集的单一抽象的使用。</li>
<li>递归可以隐藏可变状态。</li>
<li>递归是一种实现懒惰和无限大结构的方法。</li>
</ul>
<h5 id="自递归"><a href="#自递归" class="headerlink" title="自递归"></a>自递归</h5><p><strong>编写自递归函数时，规则如下(Touretzky, 1990)</strong></p>
<ul>
<li>知道什么时候停止</li>
<li>决定怎样算一个步骤</li>
<li>把问题分解成一个步骤和一个较小的问题</li>
</ul>
<table>
<thead>
<tr>
<th>函数</th>
<th>何时停止</th>
<th>进行一个步骤</th>
<th>小一些的问题</th>
</tr>
</thead>
<tbody>
<tr>
<td>myLength</td>
<td>_.isEmpty</td>
<td>1 + …</td>
<td>_.rest</td>
</tr>
<tr>
<td>cycle</td>
<td>times&lt;=0</td>
<td>cat(ary …)</td>
<td>times - 1</td>
</tr>
<tr>
<td>unzip</td>
<td>_.isEmpty</td>
<td>constructPair</td>
<td>_.rest</td>
</tr>
<tr>
<td>nexts</td>
<td>_.isEmpty</td>
<td>construct</td>
<td>_.rest</td>
</tr>
<tr>
<td>depthSearch</td>
<td>_.isEmpty</td>
<td>depthSearch(more…</td>
<td>depthSearch(cat…</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myLength</span>(<span class="params">ary</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(_.isEmpty(ary))&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span> + myLength(_.rest(ary));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cycle</span>(<span class="params">times,ary</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(times&lt;=<span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> [];</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> cat(ary,cycle(times<span class="number">-1</span>, ary));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">constructPair</span>(<span class="params">pair, rests</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> [construct(_.first(pair), _.first(rests)),</div><div class="line">             construct(second(pair),second(rests))];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 抽象的拉链</span></div><div class="line"><span class="comment">// 合上的拉链 是 左右一对一 组成的集合</span></div><div class="line"><span class="comment">// 拉开的拉链 是 左边 右边 组成的集合</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">unzip</span>(<span class="params">pairs</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(_.isEmpty(pairs))&#123;</div><div class="line">        <span class="keyword">return</span> [[],[]];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> constructPair(_.first(pairs), unzip(_.rest(pairs)));</div><div class="line">&#125;</div><div class="line">unzip(_.zip([<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</div></pre></td></tr></table></figure>
<p><strong>用递归遍历图</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> influences = [</div><div class="line">        [<span class="string">'Lisp'</span>,<span class="string">'Smalltalk'</span>],</div><div class="line">        [<span class="string">'Lisp'</span>,<span class="string">'Scheme'</span>],</div><div class="line">        [<span class="string">'Smalltalk'</span>,<span class="string">'Self'</span>],</div><div class="line">        [<span class="string">'Scheme'</span>,<span class="string">'JavaScript'</span>],</div><div class="line">        [<span class="string">'Scheme'</span>,<span class="string">'Lua'</span>],</div><div class="line">        [<span class="string">'Self'</span>,<span class="string">'Lua'</span>],</div><div class="line">        [<span class="string">'Self'</span>,<span class="string">'JavaScript'</span>]];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">nexts</span>(<span class="params">graph, node</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(_.isEmpty(graph)) <span class="keyword">return</span> [];</div><div class="line"></div><div class="line">    <span class="keyword">var</span> pair = _.first(graph);</div><div class="line">    <span class="keyword">var</span> <span class="keyword">from</span> = _.first(pair);</div><div class="line">    <span class="keyword">var</span> to = second(pair);</div><div class="line">    <span class="keyword">var</span> more = _.rest(graph);</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(_.isEqual(node, <span class="keyword">from</span>))&#123;</div><div class="line">        <span class="keyword">return</span> construct(to, nexts(more, node));</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> nexts(more, node);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">nexts(influences, <span class="string">'Lisp'</span>);</div><div class="line"><span class="comment">//=&gt; ["Smalltalk", "Scheme"]</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">rev</span>(<span class="params">ary</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.reverse.call(<span class="literal">null</span>, ary);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">depthSearch</span>(<span class="params">graph, nodes, seen</span>)</span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(_.isEmpty(nodes)) <span class="keyword">return</span> rev(seen);</div><div class="line"></div><div class="line">    <span class="keyword">var</span> node = _.first(nodes);</div><div class="line">    <span class="keyword">var</span> more = _.rest(nodes);</div><div class="line">    <span class="built_in">console</span>.log(node);</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(_.contains(seen, node))&#123;</div><div class="line">        <span class="keyword">return</span> depthSearch(graph, more, seen);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> depthSearch(graph,cat(nexts(graph,node),more),construct(node,seen));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">depthSearch(influences,[<span class="string">'Lisp'</span>],[]);</div><div class="line"><span class="comment">//=&gt; ["Lisp", "Smalltalk", "Self", "Lua", "JavaScript", "Scheme"]</span></div></pre></td></tr></table></figure>
<p><strong>尾（自）递归</strong><br>“一个步骤”和“缩小的问题”中的元素都要进行depthSearch递归调用。当对任何这些元素进行递归调用时，该函数被称为尾递归。<br>换句话说，就是函数（除了停止条件返回值）的最后一个动作是递归调用。<br>由于depthSearch的最后一次调用时一个递归调用，所以函数将永远不会再次使用。例如Scheme语言就是用这一方式来释放递归函数体重使用的资源。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tcLength</span>(<span class="params">ary,n</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> l = n ? n :<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(_.isEmpty(ary))</div><div class="line">            <span class="keyword">return</span> l;</div><div class="line">    <span class="keyword">else</span></div><div class="line">            <span class="keyword">return</span> tcLength(_.rest(ary), l+<span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>而之前的递归调用myLenght(1+…)会重复访问函数体来执行最终的加法。也许有一天，JavaScript引擎将优化尾递归函数来保持内存。<br>但现在，事实是我们被诅咒在调用堆栈上深深的递归调用中。函数的尾部位置仍然是有趣的。</p>
</blockquote>
<h5 id="递归和组合函数-Conjoin-和-Disjoin"><a href="#递归和组合函数-Conjoin-和-Disjoin" class="headerlink" title="递归和组合函数: Conjoin 和 Disjoin"></a>递归和组合函数: Conjoin 和 Disjoin</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">orify</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> preds = _.toArray(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"><span class="comment">/* args */</span></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> args = _.toArray(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> something = <span class="function"><span class="keyword">function</span> (<span class="params">ps, truth</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span>(_.isEmpty(ps))&#123;</div><div class="line">                <span class="keyword">return</span> truth;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> _.some(args, _.first(ps))</div><div class="line">                        &amp;&amp; something(_.rest(ps),truth);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> something(preds, <span class="literal">false</span>);</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> evenNums = andify(_.isNumber, isEven);</div><div class="line">evenNums(<span class="number">1</span>,<span class="number">2</span>);</div><div class="line"><span class="comment">//=&gt; false</span></div><div class="line">evenNums(<span class="number">2</span>,<span class="number">4</span>);</div><div class="line"><span class="comment">//=&gt; true</span></div></pre></td></tr></table></figure>
<h5 id="相互递归"><a href="#相互递归" class="headerlink" title="相互递归"></a>相互递归</h5><p>相互关联函数(函数调用其他会再调用回它的函数)</p>
<p><em>简单的例子</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">eventSteven</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(n===<span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> oddJohn(<span class="built_in">Math</span>.abs(n) - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">oddJohn</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(n===<span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> eventSteven(<span class="built_in">Math</span>.abs(n) - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">eventSteven(<span class="number">20</span>);</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line">oddJohn(<span class="number">11</span>);</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line"></div><div class="line"><span class="comment">// _.flatten</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">flat</span>(<span class="params">array</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(_.isArray(array))&#123;</div><div class="line">        <span class="keyword">return</span> cat.apply(cat, _.map(array, flat));</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> [array];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">flat([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]]);</div><div class="line"><span class="comment">//=&gt; [1, 2, 3, 4]</span></div></pre></td></tr></table></figure></p>
<h5 id="使用递归深克隆"><a href="#使用递归深克隆" class="headerlink" title="使用递归深克隆"></a>使用递归深克隆</h5><p><em>浅克隆</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = [&#123;a: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], b: <span class="number">42</span>&#125;, &#123;c: &#123;d: []&#125;&#125;];</div><div class="line"><span class="keyword">var</span> y = _.clone(x);</div><div class="line"><span class="built_in">console</span>.log(y);</div><div class="line"><span class="comment">//=&gt; [&#123;a: [1,2,3], b: 42&#125;, &#123;c: &#123;d: []&#125;&#125;]</span></div><div class="line">x[<span class="number">1</span>][<span class="string">'c'</span>][<span class="string">'d'</span>] = <span class="number">100000</span>;</div><div class="line"><span class="built_in">console</span>.log(y);</div><div class="line"><span class="comment">//=&gt; [&#123;a: [1,2,3], b: 42&#125;, &#123;c: &#123;d: 100000&#125;&#125;]</span></div></pre></td></tr></table></figure></p>
<p><em>深克隆</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!existy(obj) || !_.isObject(obj))&#123;</div><div class="line">        <span class="keyword">return</span> obj;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> temp = <span class="keyword">new</span> obj.constructor();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> obj)&#123;</div><div class="line">        <span class="keyword">if</span>(obj.hasOwnProperty(key))&#123;</div><div class="line">            temp[key] = deepClone(obj[key]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> temp;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> x = [&#123;a: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], b: <span class="number">42</span>&#125;, &#123;c: &#123;d: []&#125;&#125;];</div><div class="line"><span class="keyword">var</span> y = deepClone(x);</div><div class="line"></div><div class="line">_.isEqual(x, y);</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line"></div><div class="line">y[<span class="number">1</span>][<span class="string">'c'</span>][<span class="string">'d'</span>] = <span class="number">42</span>;</div><div class="line">_.isEqual(x, y);</div><div class="line"><span class="comment">//=&gt; false</span></div></pre></td></tr></table></figure></p>
<p><strong>遍历嵌套数组</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">visit</span>(<span class="params">mapFun, resultFun, array</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(_.isArray(array))&#123;</div><div class="line">        <span class="keyword">return</span> resultFun(_.map(array, mapFun));</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> resultFun(array);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">visit(_.identity, _.isNumber,<span class="number">42</span>)</div><div class="line">visit(_.isNumber, _.identity,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</div><div class="line">visit(<span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> n*<span class="number">2</span>;</div><div class="line">&#125;, rev,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">postDepth</span>(<span class="params">fun, ary</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> visit(partial(postDepth, fun), fun ,ary);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">preDepth</span>(<span class="params">fun, ary</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> visit(partial(postDepth, fun), fun ,fun(ary));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">influencedWithStrategy</span>(<span class="params">strategy,lang,graph</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> results = [];</div><div class="line">    strategy(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span>(_.isArray(x) &amp;&amp; _.first(x) === lang)</div><div class="line">                results.push(second(x));</div><div class="line">        <span class="keyword">return</span> x;</div><div class="line">    &#125;,graph);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> results;</div><div class="line">&#125;</div><div class="line">influencedWithStrategy(postDepth,<span class="string">'Lisp'</span>, influences);</div><div class="line"><span class="comment">//=&gt; ["Smalltalk", "Scheme"]</span></div><div class="line"><span class="comment">//有这个必要吗？目前还不知道</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">postDepth2</span>(<span class="params">funm,fun, ary</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> visit(partial(postDepth, funm), fun ,ary);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h5 id="太多递归了"><a href="#太多递归了" class="headerlink" title="太多递归了"></a>太多递归了</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">eventSteven(<span class="number">100000</span>)</div><div class="line"><span class="comment">//=&gt; Uncaught RangeError: Maximum call stack size exceeded</span></div></pre></td></tr></table></figure>
<p><strong>蹦床</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">evenOline</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(n === <span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> partial(oddOline, <span class="built_in">Math</span>.abs(n) - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">oddOline</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(n === <span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> partial(evenOline, <span class="built_in">Math</span>.abs(n) - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">evenOline(<span class="number">0</span>)</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line">oddOline(<span class="number">0</span>)</div><div class="line"><span class="comment">//=&gt; false</span></div><div class="line">oddOline(<span class="number">3</span>)()()();</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">trampoline</span>(<span class="params">fun <span class="comment">/*, args */</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> result = fun.apply(fun, _.rest(<span class="built_in">arguments</span>));</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(_.isFunction(result))&#123;</div><div class="line">        result = result();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isEvenSafe</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(n === <span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> trampoline(partial(oddOline, <span class="built_in">Math</span>.abs(n) - <span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isOddSafe</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(n === <span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> trampoline(partial(evenOline, <span class="built_in">Math</span>.abs(n) - <span class="number">1</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">trampoline(oddOline,<span class="number">3</span>);</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line">trampoline(evenOline,<span class="number">200000</span>);</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line">trampoline(oddOline,<span class="number">300000</span>);</div><div class="line"><span class="comment">//=&gt; false</span></div><div class="line"><span class="comment">//trampoline(evenOline,200000000);</span></div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line"></div><div class="line">isEvenSafe(<span class="number">100</span>)</div><div class="line"><span class="comment">//=&gt; true</span></div><div class="line"></div><div class="line">isOddSafe(<span class="number">100</span>)</div><div class="line"><span class="comment">//=&gt; false</span></div></pre></td></tr></table></figure>
<h5 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h5><p>因为堆比调用栈大得多，所以你使用蹦床时不太可能碰到内存耗尽的问题。<br>如果不直接使用蹦床，一般的“蹦床化(trampolineness)”的思想在JavaScript中其实一文不值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">generator</span>(<span class="params">seed, current, step</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        head: current(seed),</div><div class="line">        tail: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"forced"</span>);</div><div class="line">            <span class="keyword">return</span> generator(step(seed), current, step);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">genHead</span>(<span class="params">gen</span>)</span>&#123; <span class="keyword">return</span> gen.head &#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">genTail</span>(<span class="params">gen</span>)</span>&#123; <span class="keyword">return</span> gen.tail() &#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> ints = generator(<span class="number">0</span>, _.identity,<span class="function"><span class="keyword">function</span> (<span class="params">n</span>)</span>&#123; <span class="keyword">return</span> n+<span class="number">1</span>&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">genTake</span>(<span class="params">n, gen</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> doTake = <span class="function"><span class="keyword">function</span>(<span class="params">x,g,ret</span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(x === <span class="number">0</span>)</div><div class="line">                <span class="keyword">return</span> ret;</div><div class="line">        <span class="keyword">else</span></div><div class="line">                <span class="keyword">return</span> partial(doTake, x<span class="number">-1</span>, genTail(g), cat(ret, genHead(g)));</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> trampoline(doTake, n, gen, []);</div><div class="line">&#125;</div><div class="line">genTake(<span class="number">10</span>, ints);</div><div class="line"><span class="comment">//=&gt; forced*10</span></div><div class="line"><span class="comment">//=&gt; [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></div></pre></td></tr></table></figure>
<p><strong>蹦床原理以及回调</strong></p>
<p>使用时间循环可以使JavaScript应用程序获得最大的效率</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">asyncGetAny</span>(<span class="params">interval, urls, onsuccess, onfailure</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> n = urls.length;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> looper = <span class="function"><span class="keyword">function</span>(<span class="params">i</span>)</span>&#123;</div><div class="line">        setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span>(i &gt;= n)&#123;</div><div class="line">                onfailure(<span class="string">"failed"</span>);</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            $.get(urls[i],onsuccess)</div><div class="line">                    .always(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                        <span class="built_in">console</span>.log(<span class="string">"try:"</span> + urls[i]);</div><div class="line">                    &#125;)</div><div class="line">                    .fail(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                        looper(i+<span class="number">1</span>);</div><div class="line">                    &#125;)</div><div class="line">        &#125;, interval);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    looper(<span class="number">0</span>);</div><div class="line">    <span class="keyword">return</span> <span class="string">"go"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> urls = [<span class="string">'p1.html'</span>,<span class="string">'pp2.html'</span>,<span class="string">'pp3.html'</span>,<span class="string">'pp4.html'</span>];</div><div class="line">asyncGetAny(<span class="number">2000</span>,urls,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; alert(<span class="string">"Got  some data"</span>)&#125;,<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"all failed"</span>);</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">//GET http://127.0.0.1:8080/pp1.html 404 (Not Found)send @ jquery.js:9536ajax @ jquery.js:9143jQuery.(anonymous function) @ jquery.js:9292(anonymous function) @ a2.html:35</span></div><div class="line"><span class="comment">//try:pp1.html</span></div><div class="line"><span class="comment">//http://127.0.0.1:8080/pp2.html 404 (Not Found)send @ jquery.js:9536ajax @ jquery.js:9143jQuery.(anonymous function) @ jquery.js:9292(anonymous function) @ a2.html:35</span></div><div class="line"><span class="comment">//try:pp2.html</span></div><div class="line"><span class="comment">//GET http://127.0.0.1:8080/pp3.html 404 (Not Found)send @ jquery.js:9536ajax @ jquery.js:9143jQuery.(anonymous function) @ jquery.js:9292(anonymous function) @ a2.html:35</span></div><div class="line"><span class="comment">//try:pp3.html</span></div><div class="line"><span class="comment">//GET http://127.0.0.1:8080/pp4.html 404 (Not Found)send @ jquery.js:9536ajax @ jquery.js:9143jQuery.(anonymous function) @ jquery.js:9292(anonymous function) @ a2.html:35</span></div><div class="line"><span class="comment">//try:pp4.html</span></div><div class="line"><span class="comment">//all failed</span></div></pre></td></tr></table></figure>
<h5 id="递归是一个底层操作"><a href="#递归是一个底层操作" class="headerlink" title="递归是一个底层操作"></a>递归是一个底层操作</h5><p>这样influences的实现不仅减少了代码量，而且概念也是非常容易理解的。<br>我已经知道<em>.groupBy、</em>.first、second和_.map的用法，所以要了解<br>influenced是了解数据在函数间是如何转换的。这就是函数式编程的一大优势所在，如同乐高积木，数据流在函数管道中不断转换成最终需要的数据形式。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> groupFrom = curry2(_.groupBy)(_.first);</div><div class="line"><span class="keyword">var</span> groupTo = curry3(_.groupBy)(second);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">influenced</span>(<span class="params">graph, node</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.map(groupFrom(graph)[node],second);</div><div class="line">&#125;</div><div class="line"><span class="comment">//效果和之前实现的是一样的</span></div><div class="line">influencedWithStrategy(postDepth,<span class="string">'lisp'</span>,influences)</div></pre></td></tr></table></figure></p>
<p>首先使用函数组合，仅当需要时才使用递归和蹦床。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/25/JavaScript/functional programming/recursion/" data-id="ciunhs5j30000e0ni81qfx6w3" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/function/">function</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/recursion/">recursion</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/functional programming/Underscore_node" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/24/JavaScript/functional programming/Underscore_node/" class="article-date">
  <time datetime="2016-10-24T08:49:10.801Z" itemprop="datePublished">2016-10-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Underscore/">Underscore</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/24/JavaScript/functional programming/Underscore_node/">Underscore.js笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<blockquote>
<p>JavaScript提供统一访问其关联数据类型的能力，使得你能编写强大的通用数据操作函数套件。如JavaScript的for…in循环以及访问索引操作符成为了Underscore实现的基础。</p>
</blockquote>
<h5 id="Collection-Functions-Arrays-or-Objects"><a href="#Collection-Functions-Arrays-or-Objects" class="headerlink" title="Collection Functions (Arrays or Objects)"></a>Collection Functions (Arrays or Objects)</h5><p><a href="#map">map</a> | <a href="#each">each</a> | <a href="#reduce">reduce</a> | <a href="#reduceRight">reduceRight</a> | <a href="#find">find</a> | <a href="#filter">filter</a> | <a href="#reject">reject</a> |<br><a href="#every">every</a> | <a href="#some">some</a> | <a href="#sortBy">sortBy</a> | <a href="#groupBy">groupBy</a> | <a href="#countBy">countBy</a> | <a href="#pluck">pluck</a> | <a href="#findWhere">findWhere</a> |<br><a href="#where">where</a> | <a href="#max">max</a> | <a href="#min">min</a></p>
<hr>
<h5 id="Array-Functions"><a href="#Array-Functions" class="headerlink" title="Array Functions"></a>Array Functions</h5><p><a href="#first">first</a> | <a href="#last">last</a> | <a href="#initial">initial</a> | <a href="#rest">rest</a> | <a href="#range">range</a> | <a href="#zip">zip</a> |<br><a href="#flatten">flatten</a></p>
<hr>
<h5 id="Function-uh-ahem-Functions"><a href="#Function-uh-ahem-Functions" class="headerlink" title="Function (uh, ahem) Functions"></a>Function (uh, ahem) Functions</h5><p><a href="#bind">bind</a> | <a href="#bindAll">bindAll</a> | <a href="#wrap">wrap</a> |<a href="#compose">compose</a></p>
<hr>
<h5 id="Object-Functions"><a href="#Object-Functions" class="headerlink" title="Object Functions"></a>Object Functions</h5><p><a href="#keys">keys</a> | <a href="#allKeys">allKeys</a> | <a href="#values">values</a> | <a href="#pairs">pairs</a> | <a href="#object">object</a> | <a href="#invert">invert</a> | <a href="#defaults">defaults</a> | <a href="#omit">omit</a> | <a href="#pick">pick</a> |</p>
<hr>
<h5 id="Utility-Functions"><a href="#Utility-Functions" class="headerlink" title="Utility Functions"></a>Utility Functions</h5><p><a href="#identity">identity</a> | <a href="#noConflict">noConflict</a> | <a href="#result">result</a></p>
<hr>
<h5 id="Chaining"><a href="#Chaining" class="headerlink" title="Chaining"></a>Chaining</h5><p><a href="#value">Cvalue</a> | (chain)[#chain]</p>
<hr>
<h5 id="Collection-Functions-Arrays-or-Objects-1"><a href="#Collection-Functions-Arrays-or-Objects-1" class="headerlink" title="Collection Functions (Arrays or Objects)"></a>Collection Functions (Arrays or Objects)</h5><p><span id="map"><strong>_.map</strong> <em>映射</em></span><br>Produces a new array of values by mapping each value in list through a transformation function (iteratee). The iteratee is passed three arguments: the value, then the index (or key) of the iteration, and finally a reference to the entire list.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = _.map(&#123;a: <span class="number">1</span>, b: <span class="number">2</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">value, key, list</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(value, key, list);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//=&gt; [1,2]</span></div></pre></td></tr></table></figure></p>
<p><span id="each"><strong>_.each</strong> <em>遍历</em></span><br>Iterates over a list of elements, yielding each in turn to an iteratee function. The iteratee is bound to the context object, if one is passed. Each invocation of iteratee is called with three arguments: (element, index, list). If list is a JavaScript object, iteratee’s arguments will be (value, key, list). Returns the list for chaining.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">_.each([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], alert);</div><div class="line"><span class="comment">//=&gt; alerts each number in turn...</span></div><div class="line">_.each(&#123;one: <span class="number">1</span>, two: <span class="number">2</span>, three: <span class="number">3</span>&#125;, alert);</div><div class="line"><span class="comment">//=&gt; alerts each number value in turn...</span></div></pre></td></tr></table></figure></p>
<p><span id="reduce"><strong>_.reduce</strong> <em>简化</em></span><br>Also known as inject and foldl, reduce boils down a list of values into a single value. Memo is the initial state of the reduction, and each successive step of it should be returned by iteratee. The iteratee is passed four arguments: the memo, then the value and index (or key) of the iteration, and finally a reference to the entire list.<br>Iterates over a list of elements, yielding each in turn to an iteratee function. The iteratee is bound to the context object, if one is passed. Each invocation of iteratee is called with three arguments: (element, index, list). If list is a JavaScript object, iteratee’s arguments will be (value, key, list). Returns the list for chaining.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sum = _.reduce([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="function"><span class="keyword">function</span>(<span class="params">memo, num</span>)</span>&#123; <span class="keyword">return</span> memo + num; &#125;, <span class="number">0</span>);</div><div class="line"><span class="comment">//=&gt; 6</span></div></pre></td></tr></table></figure></p>
<p><span id="reduceRight"><strong>_.reduceRight</strong> <em>简化</em></span><br>The right-associative version of reduce. Foldr is not as useful in JavaScript as it would be in a language with lazy evaluation.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]];</div><div class="line"><span class="keyword">var</span> flat = _.reduceRight(list, <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123; <span class="keyword">return</span> a.concat(b); &#125;, []);</div><div class="line"><span class="comment">//=&gt; [4, 5, 2, 3, 0, 1]</span></div></pre></td></tr></table></figure></p>
<p><span id="find"><strong>_.find</strong> <em> </em></span><br>Looks through each value in the list, returning the first one that passes a truth test (predicate), or undefined if no value passes the test. The function returns as soon as it finds an acceptable element, and doesn’t traverse the entire list.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> even = _.find([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123; <span class="keyword">return</span> num % <span class="number">2</span> == <span class="number">0</span>; &#125;);</div><div class="line"><span class="comment">//=&gt; 2</span></div></pre></td></tr></table></figure></p>
<p><span id="filter"><strong>_.filter</strong> <em>过滤</em></span><br>Looks through each value in the list, returning the first one that passes a truth test (predicate), or undefined if no value passes the test. The function returns as soon as it finds an acceptable element, and doesn’t traverse the entire list.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> evens = _.filter([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123; <span class="keyword">return</span> num % <span class="number">2</span> == <span class="number">0</span>; &#125;);</div><div class="line"><span class="comment">//=&gt; [2, 4, 6]</span></div></pre></td></tr></table></figure></p>
<p><span id="reject"><strong>_.reject</strong> <em>滤去</em></span><br>Returns the values in list without the elements that the truth test (predicate) passes. The opposite of filter.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> odds = _.reject([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123; <span class="keyword">return</span> num % <span class="number">2</span> == <span class="number">0</span>; &#125;);</div><div class="line"><span class="comment">//=&gt; [1, 3, 5]</span></div></pre></td></tr></table></figure></p>
<p><span id="every"><strong>_.every</strong> <em> </em></span><br>Returns true if all of the values in the list pass the predicate truth test. Short-circuits and stops traversing the list if a false element is found.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.every([<span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>], <span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123; <span class="keyword">return</span> num % <span class="number">2</span> == <span class="number">0</span>; &#125;);</div><div class="line"><span class="comment">//=&gt; false</span></div></pre></td></tr></table></figure></p>
<p><span id="some"><strong>_.some</strong> <em> </em></span><br>Returns true if any of the values in the list pass the predicate truth test. Short-circuits and stops traversing the list if a true element is found.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.some([<span class="literal">null</span>, <span class="number">0</span>, <span class="string">'yes'</span>, <span class="literal">false</span>]);</div><div class="line"><span class="comment">//=&gt; true</span></div></pre></td></tr></table></figure></p>
<p><span id="sortBy"><strong>_.sortBy</strong> <em> </em></span><br>Returns a (stably) sorted copy of list, ranked in ascending order by the results of running each value through iteratee. iteratee may also be the string name of the property to sort by (eg. length).<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">_.sortBy([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123; <span class="keyword">return</span> <span class="built_in">Math</span>.sin(num); &#125;);</div><div class="line"><span class="comment">//=&gt; [5, 4, 6, 3, 1, 2]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> stooges = [&#123;name: <span class="string">'moe'</span>, age: <span class="number">40</span>&#125;, &#123;name: <span class="string">'larry'</span>, age: <span class="number">50</span>&#125;, &#123;name: <span class="string">'curly'</span>, age: <span class="number">60</span>&#125;];</div><div class="line">_.sortBy(stooges, <span class="string">'name'</span>);</div><div class="line"><span class="comment">//=&gt; [&#123;name: 'curly', age: 60&#125;, &#123;name: 'larry', age: 50&#125;, &#123;name: 'moe', age: 40&#125;];</span></div></pre></td></tr></table></figure></p>
<p><span id="groupBy"><strong>_.groupBy</strong> <em> </em></span><br>Splits a collection into sets, grouped by the result of running each value through iteratee. If iteratee is a string instead of a function, groups by the property named by iteratee on each of the values.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">_.groupBy([<span class="number">1.3</span>, <span class="number">2.1</span>, <span class="number">2.4</span>], <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123; <span class="keyword">return</span> <span class="built_in">Math</span>.floor(num); &#125;);</div><div class="line"><span class="comment">//=&gt; &#123;1: [1.3], 2: [2.1, 2.4]&#125;</span></div><div class="line"></div><div class="line">_.groupBy([<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>], <span class="string">'length'</span>);</div><div class="line"><span class="comment">//=&gt; &#123;3: ["one", "two"], 5: ["three"]&#125;</span></div></pre></td></tr></table></figure></p>
<p><span id="countBy"><strong>_.countBy</strong> <em> </em></span><br>Sorts a list into groups and returns a count for the number of objects in each group. Similar to groupBy, but instead of returning a list of values, returns a count for the number of values in that group.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">_.countBy([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], <span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> num % <span class="number">2</span> == <span class="number">0</span> ? <span class="string">'even'</span>: <span class="string">'odd'</span>;</div><div class="line">&#125;);</div><div class="line">=&gt; &#123;odd: <span class="number">3</span>, even: <span class="number">2</span>&#125;</div></pre></td></tr></table></figure></p>
<p><span id="pluck"><strong>_.pluck</strong> <em> </em></span><br>A convenient version of what is perhaps the most common use-case for map: extracting a list of property values.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stooges = [&#123;name: <span class="string">'moe'</span>, age: <span class="number">40</span>&#125;, &#123;name: <span class="string">'larry'</span>, age: <span class="number">50</span>&#125;, &#123;name: <span class="string">'curly'</span>, age: <span class="number">60</span>&#125;];</div><div class="line">_.pluck(stooges, <span class="string">'name'</span>);</div><div class="line"><span class="comment">//=&gt; ["moe", "larry", "curly"]</span></div></pre></td></tr></table></figure></p>
<p><span id="findWhere"><strong>_.findWhere</strong> <em> </em></span><br>Looks through the list and returns the first value that matches all of the key-value pairs listed in properties.<br>If no match is found, or if list is empty, undefined will be returned.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> library = [&#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262010771"</span>, ed: <span class="number">1</span>&#125;, &#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262510871"</span>, ed: <span class="number">2</span>&#125;, &#123;title: <span class="string">"Joy of Clojure"</span>, isbn: <span class="string">"1935182641"</span>, ed: <span class="number">1</span>&#125;];</div><div class="line">_.findWhere(library, &#123;title: <span class="string">"SICP"</span>&#125;);</div><div class="line"><span class="comment">//=&gt; &#123;title: "SICP", isbn: "0262010771", ed: 1&#125;</span></div></pre></td></tr></table></figure></p>
<p><span id="where"><strong>_.where</strong> <em> </em></span><br>Looks through each value in the list, returning an array of all the values that contain all of the key-value pairs listed in properties.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> library = [&#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262010771"</span>, ed: <span class="number">1</span>&#125;, &#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262510871"</span>, ed: <span class="number">2</span>&#125;, &#123;title: <span class="string">"Joy of Clojure"</span>, isbn: <span class="string">"1935182641"</span>, ed: <span class="number">1</span>&#125;];</div><div class="line">_.where(library, &#123;title: <span class="string">"SICP"</span>&#125;);</div><div class="line"><span class="comment">//=&gt; &#123;title: "SICP", isbn: "0262010771", ed: 1&#125;</span></div><div class="line"><span class="comment">//=&gt; &#123;title: "SICP", isbn: "0262510871", ed: 2&#125;</span></div></pre></td></tr></table></figure></p>
<p><span id="max"><strong>_.max</strong> <em> </em></span><br>Returns the maximum value in list. If an iteratee function is provided, it will be used on each value to generate the criterion by which the value is ranked. -Infinity is returned if list is empty, so an isEmpty guard may be required. Non-numerical values in list will be ignored.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stooges = [&#123;name: <span class="string">'moe'</span>, age: <span class="number">40</span>&#125;, &#123;name: <span class="string">'larry'</span>, age: <span class="number">50</span>&#125;, &#123;name: <span class="string">'curly'</span>, age: <span class="number">60</span>&#125;];</div><div class="line">_.max(stooges, <span class="function"><span class="keyword">function</span>(<span class="params">stooge</span>)</span>&#123; <span class="keyword">return</span> stooge.age; &#125;);</div><div class="line">=&gt; &#123;name: <span class="string">'curly'</span>, age: <span class="number">60</span>&#125;;</div></pre></td></tr></table></figure></p>
<p><span id="min"><strong>_.min</strong> <em> </em></span><br>Returns the minimum value in list. If an iteratee function is provided, it will be used on each value to generate the criterion by which the value is ranked. Infinity is returned if list is empty, so an isEmpty guard may be required. Non-numerical values in list will be ignored.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> numbers = [<span class="number">10</span>, <span class="number">5</span>, <span class="number">100</span>, <span class="number">2</span>, <span class="number">1000</span>];</div><div class="line">_.min(numbers);</div><div class="line">=&gt; <span class="number">2</span></div></pre></td></tr></table></figure></p>
<hr>
<h5 id="Array-Functions-1"><a href="#Array-Functions-1" class="headerlink" title="Array Functions"></a>Array Functions</h5><p><span id="first"><strong>_.first</strong> <em> </em></span><br>Returns the first element of an array. Passing n will return the first n elements of the array.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">_.first([<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]);</div><div class="line"><span class="comment">// =&gt; 5</span></div><div class="line">_.first([<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>],<span class="number">3</span>);</div><div class="line"><span class="comment">// =&gt; [5, 4, 3]</span></div></pre></td></tr></table></figure></p>
<p><span id="last"><strong>_.last</strong> <em> </em></span><br>Returns the last element of an array. Passing n will return the last n elements of the array.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.last([<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]);</div><div class="line">=&gt; <span class="number">1</span></div></pre></td></tr></table></figure></p>
<p><span id="initial"><strong>_.initial</strong> <em> </em></span><br>Returns everything but the last entry of the array. Especially useful on the arguments object. Pass n to exclude the last n elements from the result.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.initial([<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]);</div><div class="line">=&gt; [<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</div></pre></td></tr></table></figure></p>
<p><span id="rest"><strong>_.rest</strong> <em> </em></span><br>Returns the rest of the elements in an array. Pass an index to return the values of the array from that index onward.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.rest([<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]);</div><div class="line"><span class="comment">//=&gt; [4, 3, 2, 1]</span></div></pre></td></tr></table></figure></p>
<p><span id="range"><strong>_.range</strong> <em> </em></span><br>A function to create flexibly-numbered lists of integers, handy for each and map loops. start, if omitted, defaults to 0; step defaults to 1. Returns a list of integers from start (inclusive) to stop (exclusive), incremented (or decremented) by step, exclusive. Note that ranges that stop before they start are considered to be zero-length instead of negative — if you’d like a negative range, use a negative step.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">_.range(<span class="number">10</span>);</div><div class="line"><span class="comment">//=&gt; [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></div><div class="line">_.range(<span class="number">1</span>, <span class="number">11</span>);</div><div class="line"><span class="comment">//=&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></div><div class="line">_.range(<span class="number">0</span>, <span class="number">30</span>, <span class="number">5</span>);</div><div class="line"><span class="comment">//=&gt; [0, 5, 10, 15, 20, 25]</span></div><div class="line">_.range(<span class="number">0</span>, <span class="number">-10</span>, <span class="number">-1</span>);</div><div class="line"><span class="comment">//=&gt; [0, -1, -2, -3, -4, -5, -6, -7, -8, -9]</span></div><div class="line">_.range(<span class="number">0</span>);</div><div class="line"><span class="comment">//=&gt; []</span></div></pre></td></tr></table></figure></p>
<p><span id="last"><strong>_.zip</strong> <em> </em></span><br>Merges together the values of each of the arrays with the values at the corresponding position. Useful when you have separate data sources that are coordinated through matching array indexes. Use with apply to pass in an array of arrays. If you’re working with a matrix of nested arrays, this can be used to transpose the matrix.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.zip([<span class="string">'moe'</span>, <span class="string">'larry'</span>, <span class="string">'curly'</span>], [<span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>], [<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>]);</div><div class="line">=&gt; [[<span class="string">"moe"</span>, <span class="number">30</span>, <span class="literal">true</span>], [<span class="string">"larry"</span>, <span class="number">40</span>, <span class="literal">false</span>], [<span class="string">"curly"</span>, <span class="number">50</span>, <span class="literal">false</span>]]</div></pre></td></tr></table></figure></p>
<p><span id="flatten"><strong>_.flatten</strong> <em> </em></span><br>Flattens a nested array (the nesting can be to any depth). If you pass shallow, the array will only be flattened a single level.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">_.flatten([<span class="number">1</span>, [<span class="number">2</span>], [<span class="number">3</span>, [[<span class="number">4</span>]]]]);</div><div class="line">=&gt; [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line"></div><div class="line">_.flatten([<span class="number">1</span>, [<span class="number">2</span>], [<span class="number">3</span>, [[<span class="number">4</span>]]]], <span class="literal">true</span>);</div><div class="line">=&gt; [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [[<span class="number">4</span>]]];</div></pre></td></tr></table></figure></p>
<hr>
<h5 id="Function-uh-ahem-Functions-1"><a href="#Function-uh-ahem-Functions-1" class="headerlink" title="Function (uh, ahem) Functions"></a>Function (uh, ahem) Functions</h5><p><span id="bind"><strong>_.bind</strong> <em> </em></span><br>Bind a function to an object, meaning that whenever the function is called, the value of this will be the object. Optionally, pass arguments to the function to pre-fill them, also known as partial application. For partial application without context binding, use partial.<br>this绑定后不会被call，apply改变<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span>(<span class="params">greeting</span>)</span>&#123; <span class="keyword">return</span> greeting + <span class="string">': '</span> + <span class="keyword">this</span>.name &#125;;</div><div class="line">func = _.bind(func, &#123;name: <span class="string">'moe'</span>&#125;, <span class="string">'hi'</span>);</div><div class="line">func();</div><div class="line"><span class="comment">//=&gt; 'hi: moe'</span></div></pre></td></tr></table></figure></p>
<p><span id="bindAll"><strong>_.bindAll</strong> <em> </em></span><br>Binds a number of methods on the object, specified by methodNames, to be run in the context of that object whenever they are invoked. Very handy for binding functions that are going to be used as event handlers, which would otherwise be invoked with a fairly useless this. methodNames are required.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> buttonView = &#123;</div><div class="line">  label  : <span class="string">'underscore'</span>,</div><div class="line">  onClick: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; alert(<span class="string">'clicked: '</span> + <span class="keyword">this</span>.label); &#125;,</div><div class="line">  onHover: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">'hovering: '</span> + <span class="keyword">this</span>.label); &#125;</div><div class="line">&#125;;</div><div class="line">_.bindAll(buttonView, <span class="string">'onClick'</span>, <span class="string">'onHover'</span>);</div><div class="line"><span class="comment">// When the button is clicked, this.label will have the correct value.</span></div><div class="line">jQuery(<span class="string">'#underscore_button'</span>).on(<span class="string">'click'</span>, buttonView.onClick);</div></pre></td></tr></table></figure></p>
<p><span id="compose"><strong>_.compose</strong> <em>起到了粘合作用，函数从右向左执行，最右边函数的结果会被送入其左侧的函数，一个接一个。</em></span><br>Returns the composition of a list of functions, where each function consumes the return value of the function that follows. In math terms, composing the functions f(), g(), and h() produces f(g(h())).<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> greet    = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123; <span class="keyword">return</span> <span class="string">"hi: "</span> + name; &#125;;</div><div class="line"><span class="keyword">var</span> exclaim  = <span class="function"><span class="keyword">function</span>(<span class="params">statement</span>)</span>&#123; <span class="keyword">return</span> statement.toUpperCase() + <span class="string">"!"</span>; &#125;;</div><div class="line"><span class="keyword">var</span> welcome = _.compose(greet, exclaim);</div><div class="line">welcome(<span class="string">'moe'</span>);</div><div class="line">=&gt; <span class="string">'hi: MOE!'</span></div></pre></td></tr></table></figure></p>
<hr>
<h5 id="Object-Functions-1"><a href="#Object-Functions-1" class="headerlink" title="Object Functions"></a>Object Functions</h5><p><span id="keys"><strong>_.keys</strong> <em> </em></span><br>Retrieve all the names of the object’s own enumerable properties.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.keys(&#123;one: <span class="number">1</span>, two: <span class="number">2</span>, three: <span class="number">3</span>&#125;);</div><div class="line"><span class="comment">//=&gt; ["one", "two", "three"]</span></div></pre></td></tr></table></figure></p>
<p><span id="allKeys"><strong>_.allKeys</strong> <em> </em></span><br>Retrieve all the names of object’s own and inherited properties.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Stooge</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name;</div><div class="line">&#125;</div><div class="line">Stooge.prototype.silly = <span class="literal">true</span>;</div><div class="line">_.allKeys(<span class="keyword">new</span> Stooge(<span class="string">"Moe"</span>));</div><div class="line"><span class="comment">//=&gt; ["name", "silly"]</span></div></pre></td></tr></table></figure></p>
<p><span id="values"><strong>_.values</strong> <em> </em></span><br>Return all of the values of the object’s own properties.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.values(&#123;one: <span class="number">1</span>, two: <span class="number">2</span>, three: <span class="number">3</span>&#125;);</div><div class="line"><span class="comment">//=&gt; [1, 2, 3]</span></div></pre></td></tr></table></figure></p>
<p><span id="pairs"><strong>_.pairs</strong> <em>嵌套数组</em></span><br>Convert an object into a list of [key, value] pairs.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.pairs(&#123;one: <span class="number">1</span>, two: <span class="number">2</span>, three: <span class="number">3</span>&#125;);</div><div class="line"><span class="comment">//=&gt; [["one", 1], ["two", 2], ["three", 3]]</span></div></pre></td></tr></table></figure></p>
<p><span id="object"><strong>_.object</strong> <em>转换成对象</em></span><br>Converts arrays into objects. Pass either a single list of [key, value] pairs, or a list of keys, and a list of values. If duplicate keys exist, the last value wins.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">_.object([<span class="string">'moe'</span>, <span class="string">'larry'</span>, <span class="string">'curly'</span>], [<span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]);</div><div class="line">=&gt; &#123;moe: <span class="number">30</span>, larry: <span class="number">40</span>, curly: <span class="number">50</span>&#125;</div><div class="line"></div><div class="line">_.object([[<span class="string">'moe'</span>, <span class="number">30</span>], [<span class="string">'larry'</span>, <span class="number">40</span>], [<span class="string">'curly'</span>, <span class="number">50</span>]]);</div><div class="line">=&gt; &#123;moe: <span class="number">30</span>, larry: <span class="number">40</span>, curly: <span class="number">50</span>&#125;</div></pre></td></tr></table></figure></p>
<p><span id="invert"><strong>_.invert</strong> <em>反转对象</em></span><br>Returns a copy of the object where the keys have become the values and the values the keys. For this to work, all of your object’s values should be unique and string serializable.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.invert(&#123;Moe: <span class="string">"Moses"</span>, Larry: <span class="string">"Louis"</span>, Curly: <span class="string">"Jerome"</span>&#125;);</div><div class="line">=&gt; &#123;Moses: <span class="string">"Moe"</span>, Louis: <span class="string">"Larry"</span>, Jerome: <span class="string">"Curly"</span>&#125;;</div></pre></td></tr></table></figure></p>
<p><span id="defaults"><strong>_.defaults</strong> <em> </em></span><br>Fill in undefined properties in object with the first value present in the following list of defaults objects.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> iceCream = &#123;flavor: <span class="string">"chocolate"</span>&#125;;</div><div class="line">_.defaults(iceCream, &#123;flavor: <span class="string">"vanilla"</span>, sprinkles: <span class="string">"lots"</span>&#125;);</div><div class="line">=&gt; &#123;flavor: <span class="string">"chocolate"</span>, sprinkles: <span class="string">"lots"</span>&#125;</div></pre></td></tr></table></figure></p>
<p><span id="omit"><strong>_.omit</strong> <em> </em></span><br>Return a copy of the object, filtered to omit the blacklisted keys (or array of keys). Alternatively accepts a predicate indicating which keys to omit.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">_.omit(&#123;name: <span class="string">'moe'</span>, age: <span class="number">50</span>, userid: <span class="string">'moe1'</span>&#125;, <span class="string">'userid'</span>);</div><div class="line"><span class="comment">//=&gt; &#123;name: 'moe', age: 50&#125;</span></div><div class="line">_.omit(&#123;name: <span class="string">'moe'</span>, age: <span class="number">50</span>, userid: <span class="string">'moe1'</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">value, key, object</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> _.isNumber(value);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//=&gt; &#123;name: 'moe', userid: 'moe1'&#125;</span></div></pre></td></tr></table></figure></p>
<p><span id="pick"><strong>_.pick</strong> <em> </em></span><br>Return a copy of the object, filtered to only have values for the whitelisted keys (or array of valid keys). Alternatively accepts a predicate indicating which keys to pick.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">_.pick(&#123;name: <span class="string">'moe'</span>, age: <span class="number">50</span>, userid: <span class="string">'moe1'</span>&#125;, <span class="string">'name'</span>, <span class="string">'age'</span>);</div><div class="line"><span class="comment">//=&gt; &#123;name: 'moe', age: 50&#125;</span></div><div class="line">_.pick(&#123;name: <span class="string">'moe'</span>, age: <span class="number">50</span>, userid: <span class="string">'moe1'</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">value, key, object</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> _.isNumber(value);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//=&gt; &#123;age: 50&#125;</span></div></pre></td></tr></table></figure></p>
<hr>
<h5 id="Utility-Functions-1"><a href="#Utility-Functions-1" class="headerlink" title="Utility Functions"></a>Utility Functions</h5><p><span id="identity"><strong>_.identity</strong> <em>恒等式</em></span><br>Returns the same value that is used as the argument. In math: f(x) = x This function looks useless, but is used throughout Underscore as a default iteratee.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = _.map(&#123;a: <span class="number">1</span>, b: <span class="number">2</span>&#125;, _.identity)</div><div class="line"><span class="built_in">console</span>.log(arr);</div><div class="line"><span class="comment">//=&gt; 1 "a" Object &#123;a: 1, b: 2&#125;</span></div><div class="line"><span class="comment">//=&gt; 2 "b" Object &#123;a: 1, b: 2&#125;</span></div></pre></td></tr></table></figure></p>
<p><span id="noConflict"><strong>_.noConflict</strong> <em> </em></span><br>Give control of the _ variable back to its previous owner. Returns a reference to the Underscore object.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> underscore = _.noConflict();</div></pre></td></tr></table></figure></p>
<p><span id="result"><strong>_.result</strong> <em> </em></span><br>If the value of the named property is a function then invoke it with the object as context; otherwise, return it. If a default value is provided and the property doesn’t exist or is undefined then the default will be returned. If defaultValue is a function its result will be returned.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> object = &#123;cheese: <span class="string">'crumpets'</span>, stuff: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="string">'nonsense'</span>; &#125;&#125;;</div><div class="line">_.result(object, <span class="string">'cheese'</span>);</div><div class="line">=&gt; <span class="string">"crumpets"</span></div><div class="line">_.result(object, <span class="string">'stuff'</span>);</div><div class="line">=&gt; <span class="string">"nonsense"</span></div><div class="line">_.result(object, <span class="string">'meat'</span>, <span class="string">'ham'</span>);</div><div class="line">=&gt; <span class="string">"ham"</span></div></pre></td></tr></table></figure></p>
<hr>
<h5 id="Chaining-1"><a href="#Chaining-1" class="headerlink" title="Chaining"></a>Chaining</h5><p><span id="Cvalue"><strong>_.value</strong> <em> </em></span><br>Extracts the value of a wrapped object.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_.chain([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]).reverse().value();</div><div class="line">=&gt; [<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</div></pre></td></tr></table></figure></p>
<p><span id="chain"><strong>_.chain</strong> <em> </em></span><br>Returns a wrapped object. Calling methods on this object will continue to return wrapped objects until value is called.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> stooges = [&#123;name: <span class="string">'curly'</span>, age: <span class="number">25</span>&#125;, &#123;name: <span class="string">'moe'</span>, age: <span class="number">21</span>&#125;, &#123;name: <span class="string">'larry'</span>, age: <span class="number">23</span>&#125;];</div><div class="line"><span class="keyword">var</span> youngest = _.chain(stooges)</div><div class="line">  .sortBy(<span class="function"><span class="keyword">function</span>(<span class="params">stooge</span>)</span>&#123; <span class="keyword">return</span> stooge.age; &#125;)</div><div class="line">  .map(<span class="function"><span class="keyword">function</span>(<span class="params">stooge</span>)</span>&#123; <span class="keyword">return</span> stooge.name + <span class="string">' is '</span> + stooge.age; &#125;)</div><div class="line">  .first()</div><div class="line">  .value();</div><div class="line">=&gt; <span class="string">"moe is 21"</span></div></pre></td></tr></table></figure></p>
<hr>
<h5 id="谓词函数"><a href="#谓词函数" class="headerlink" title="谓词函数"></a>谓词函数</h5><ol>
<li>isNumber</li>
<li>isEqual</li>
<li>isEmpty</li>
<li>isElement</li>
<li>isArray</li>
<li>isObject</li>
<li>isArguments</li>
<li>isFunction</li>
<li>isString</li>
<li>isNumber</li>
<li>isFinite</li>
<li>isBoolean</li>
<li>isDate</li>
<li>isRegExp</li>
<li>isNaN</li>
<li>isNull</li>
<li>isUndefined</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/24/JavaScript/functional programming/Underscore_node/" data-id="ciugro2y40006wcni62zrr37j" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/function/">function</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/functional programming/curry" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/22/JavaScript/functional programming/curry/" class="article-date">
  <time datetime="2016-10-22T06:44:23.969Z" itemprop="datePublished">2016-10-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/22/JavaScript/functional programming/curry/">柯里化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>柯里化函数逐渐返回消耗参数的函数，直到所有参数耗尽。</p>
<p>向左柯里化让你能修复可选参数的值</p>
<h5 id="自动柯里化参数"><a href="#自动柯里化参数" class="headerlink" title="自动柯里化参数"></a>自动柯里化参数</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">fun</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> fun(arg);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用curry，可以强制parseInt在每次调用时只接收一个参数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">parseInt</span>(<span class="string">'11'</span>);</div><div class="line"><span class="comment">//=&gt; 11</span></div><div class="line"><span class="built_in">parseInt</span>(<span class="string">'11'</span>,<span class="number">2</span>);</div><div class="line"><span class="comment">//=&gt; 3</span></div><div class="line"></div><div class="line">[<span class="string">'11'</span>,<span class="string">'11'</span>,<span class="string">'11'</span>,<span class="string">'11'</span>].map(<span class="built_in">parseInt</span>);</div><div class="line"><span class="comment">//=&gt; [11, NaN, 3, 4]</span></div><div class="line"></div><div class="line">[<span class="string">'11'</span>,<span class="string">'11'</span>,<span class="string">'11'</span>,<span class="string">'11'</span>].map(curry(<span class="built_in">parseInt</span>));</div><div class="line"><span class="comment">//=&gt; [11, 11, 11, 11]</span></div></pre></td></tr></table></figure></p>
<p>一个柯里化两个参数的curry2函数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry2</span>(<span class="params">fun</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">secondArg</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">firstArg</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> fun(firstArg, secondArg);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> parseBinaryString = curry2(<span class="built_in">parseInt</span>)(<span class="number">2</span>);</div><div class="line">parseBinaryString(<span class="string">"111"</span>);</div><div class="line"><span class="comment">//=&gt; 7</span></div><div class="line">parseBinaryString(<span class="string">"10"</span>);</div><div class="line"><span class="comment">//=&gt; 2</span></div></pre></td></tr></table></figure></p>
<p>使用柯里化构建新函数<br>使用柯里化来使得函数式接口更可读<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//normal</span></div><div class="line"><span class="keyword">var</span> plays = [&#123;artist: <span class="string">"Burial"</span>, track: <span class="string">"Archange"</span>&#125;,</div><div class="line">              &#123;artist: <span class="string">"Ben Frost"</span>, track: <span class="string">"Stomp"</span>&#125;,</div><div class="line">              &#123;artist: <span class="string">"Ben Frost"</span>, track: <span class="string">"Stomp"</span>&#125;,</div><div class="line">              &#123;artist: <span class="string">"Burial"</span>, track: <span class="string">"Archange"</span>&#125;,</div><div class="line">              &#123;artist: <span class="string">"Emeralds"</span>, track: <span class="string">"Snores"</span>&#125;,</div><div class="line">              &#123;artist: <span class="string">"Burial"</span>, track: <span class="string">"Archange"</span>&#125;];</div><div class="line"></div><div class="line"><span class="keyword">var</span> a= _.countBy(plays, <span class="function"><span class="keyword">function</span> (<span class="params">song</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> [song.artist, song.track].join(<span class="string">" - "</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">//=&gt;  &#123;Burial - Archange: 3, Ben Frost - Stomp: 2, Emeralds - Snores: 1&#125;</span></div><div class="line"></div><div class="line"><span class="comment">//柯里化</span></div><div class="line"><span class="comment">//使用柯里化形成了一个虚拟的句子，有效地陈述“实现 songCount, countBy, songToString.”</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">songToString</span>(<span class="params">song</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> [song.artist, song.track].join(<span class="string">" - "</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> songCount = curry2(_.countBy)(songToString);</div><div class="line">songCount(plays);</div><div class="line"><span class="comment">//=&gt;  &#123;Burial - Archange: 3, Ben Frost - Stomp: 2, Emeralds - Snores: 1&#125;</span></div></pre></td></tr></table></figure></p>
<p>一个柯里化三个参数的curry3函数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry3</span>(<span class="params">fun</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">last</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">middle</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">first</span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> fun(first, middle, last);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> songsPlayed = curry3(_.uniq)(songToString)(<span class="literal">false</span>);</div><div class="line">songsPlayed(plays);</div><div class="line"><span class="comment">//=&gt; &#123;&#123;artist: "Burial", track: "Archange"&#125;,&#123;artist: "Ben Frost", track: "Stomp"&#125;,&#123;artist: "Emeralds", track: "Snores"&#125;&#125;</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">toHex</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> hex = n.toString(<span class="number">16</span>);</div><div class="line">    <span class="keyword">return</span> (hex.length &lt; <span class="number">2</span>) ? [<span class="number">0</span>, hex].join(<span class="string">''</span>) : hex;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">rgbToHexString</span>(<span class="params">r, g, b</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">"#"</span>, toHex(r), toHex(g), toHex(b)].join(<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> blueGreenish = curry3(rgbToHexString)(<span class="number">255</span>)(<span class="number">200</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> greaterThan = curry2(<span class="function"><span class="keyword">function</span>(<span class="params">lhs, rhs</span>)</span>&#123; <span class="keyword">return</span> lhs&gt; rhs&#125;);</div><div class="line"><span class="keyword">var</span> lessThan = curry2(<span class="function"><span class="keyword">function</span>(<span class="params">lhs, rhs</span>)</span>&#123; <span class="keyword">return</span> lhs&lt; rhs&#125;);</div><div class="line"></div><div class="line"><span class="keyword">var</span> withinRange = checker(</div><div class="line">    validator(<span class="string">"arg must be greater than 10"</span>, greaterThan(<span class="number">10</span>)),</div><div class="line">    validator(<span class="string">"arg must be less than 20"</span>, lessThan(<span class="number">20</span>))</div><div class="line">);</div><div class="line">withinRange(<span class="number">15</span>);</div><div class="line"><span class="comment">//=&gt; []</span></div><div class="line">withinRange(<span class="number">1</span>);</div><div class="line"><span class="comment">//=&gt; ["arg must be greater than 10"]</span></div><div class="line">withinRange(<span class="number">100</span>);</div><div class="line"><span class="comment">//=&gt; ["arg must be less than 20"]</span></div></pre></td></tr></table></figure></p>
<p>curry3和curry3对于API的设计是有用的，而且他们也可以优雅地实现函数式组合。不过，在任意层次上部分应用函数要比柯里化更实用。</p>
<h5 id="部分应用任意数量的参数"><a href="#部分应用任意数量的参数" class="headerlink" title="部分应用任意数量的参数"></a>部分应用任意数量的参数</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">div</span>(<span class="params">n, m</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> m/n;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">partial</span>(<span class="params">fun <span class="comment">/* , pargs */</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> pargs = _.rest(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"><span class="comment">/* arguments */</span></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> args = cat(pargs, _.toArray(<span class="built_in">arguments</span>));</div><div class="line">        <span class="keyword">return</span> fun.apply(fun, args);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> over10Partial = partial(div,<span class="number">10</span>);</div><div class="line">over10Partial(<span class="number">2</span>);</div><div class="line"><span class="comment">//=&gt; 0.2</span></div><div class="line"><span class="keyword">var</span> over10Partial = partial(div,<span class="number">10</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>);</div><div class="line"><span class="comment">//=&gt; 0.2</span></div></pre></td></tr></table></figure>
<h5 id="部分应用"><a href="#部分应用" class="headerlink" title="部分应用"></a>部分应用</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">conditionl</span>(<span class="params"><span class="comment">/* validators */</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span>  validators = _.toArray(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">fun, arg</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> errors = mapcat(<span class="function"><span class="keyword">function</span>(<span class="params">isValid</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> isValid(arg) ? [] : [isValid[<span class="string">'message'</span>]];</div><div class="line">        &#125;, validators);</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(!_.isEmpty(errors))&#123;</div><div class="line">            fail(errors.join(<span class="string">", "</span>));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> fun(arg);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isZero</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> n===<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">complement</span>(<span class="params">fun</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> !fun.call(<span class="literal">null</span>, arg);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> sqrPre = conditionl(validator(<span class="string">'arg must not be zero'</span>,  complement(isZero)),validator(<span class="string">'arg mmust be a number'</span>, _.isNumber));</div><div class="line">sqrPre(_.identity,<span class="number">10</span>)</div><div class="line"><span class="comment">//=&gt; arg must not be zero</span></div><div class="line">sqrPre(_.identity,<span class="string">""</span>);</div><div class="line"><span class="comment">//=&gt; arg mmust be a number</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">uncheckedSqr</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> n * n;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> checkedSqr = partial(sqrPre, uncheckedSqr);</div><div class="line">checkedSqr(<span class="number">10</span>);</div><div class="line"><span class="comment">//=&gt; 100</span></div><div class="line">checkedSqr(<span class="number">0</span>);</div><div class="line"><span class="comment">//=&gt; arg must not be zero</span></div><div class="line">checkedSqr(<span class="string">""</span>);</div><div class="line"><span class="comment">//=&gt; arg must be a number</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> sillySquare = partial(conditionl(validator(<span class="string">"should be even"</span>), isEven),sqrPre)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> validateCommand = conditionl(validator(<span class="string">"arg must be a map"</span>, _.isObject), validator(<span class="string">"arg must have the correct keys"</span>,hasKeys(<span class="string">'msg'</span>, <span class="string">'type'</span>)));</div><div class="line"></div><div class="line"><span class="keyword">var</span> createCommand = partial(validateCommand, _.identity);</div><div class="line"><span class="comment">//createCommand(&#123;&#125;);</span></div><div class="line"><span class="comment">//=&gt; arg must have the correct keys</span></div><div class="line"><span class="comment">//createCommand(2)</span></div><div class="line"><span class="comment">//=&gt; arg must be a map, arg must have the correct keys</span></div><div class="line">createCommand(&#123;msg:<span class="string">""</span>, type:<span class="string">""</span>&#125;);</div><div class="line"><span class="comment">//=&gt; &#123;msg: "", type: ""&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> creatLaunchCommand = partial(conditionl(validator(<span class="string">"arg must have the countDown"</span>,hasKeys(<span class="string">'countDown'</span>))),createCommand);</div><div class="line"></div><div class="line"><span class="comment">//creatLaunchCommand(&#123;msg: "", type:""&#125;)</span></div><div class="line"><span class="comment">//=&gt; arg must have the count down</span></div><div class="line"></div><div class="line"><span class="comment">//creatLaunchCommand(&#123;msg: "", type:"",countDown: 10&#125;)</span></div><div class="line"><span class="comment">//=&gt; &#123;msg: "", type: "", countDown: 10&#125;</span></div></pre></td></tr></table></figure>
<h5 id="组合前置与后置条件"><a href="#组合前置与后置条件" class="headerlink" title="组合前置与后置条件"></a>组合前置与后置条件</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sqrPost = conditionl(</div><div class="line">        validator(<span class="string">"result should be a number"</span>, _.isNumber),</div><div class="line">        validator(<span class="string">"result should not be zero"</span>, complement(isZero)),</div><div class="line">        validator(<span class="string">"result should be positive"</span>, greaterThan(<span class="number">0</span>))</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">var</span> megaCheckedSqr = _.compose(partial(sqrPost, _.identity), checkedSqr);</div><div class="line"><span class="comment">//megaCheckedSqr(NaN);</span></div><div class="line"><span class="comment">//=&gt; result should be positive</span></div></pre></td></tr></table></figure>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本章中介绍了无论是通用还是专有函数，新的函数可以从现有的函数来构建的理念。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/22/JavaScript/functional programming/curry/" data-id="ciuktlt1s0000uonit6cda2uv" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/curry/">curry</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/functional programming/useful" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/20/JavaScript/functional programming/useful/" class="article-date">
  <time datetime="2016-10-20T08:08:44.271Z" itemprop="datePublished">2016-10-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Underscore/">Underscore</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/20/JavaScript/functional programming/useful/">常用函数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p><em>正如伟大的首位图灵奖获得者Alan Perlis曾经说的:</em><br>用100个函数操作一个数据结构，比用10个函数操作10个数据结构要好。</p>
</blockquote>
<p>用较低级别的函数来逐步定义和使用离散功能。一串函数链一个接一个地调用，每一个函数将逐渐转变的结果传递到后一个函数，最后得到解决方案。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">thing</span>)</span>&#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(thing);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">warn</span>(<span class="params">thing</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log([<span class="string">"WARNING:"</span>, thing].join(<span class="string">' '</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">note</span>(<span class="params">thing</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log([<span class="string">"NOTE:"</span>, thing].join(<span class="string">' '</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isIndexed</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.isArray(data) || _.isString(data);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">nth</span>(<span class="params">a, index</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!_.isNumber(index)) fail(<span class="string">"Expected a number as the index"</span>);</div><div class="line">    <span class="keyword">if</span>(!isIndexed(a)) fail(<span class="string">"Not supported on non-indexed type"</span>);</div><div class="line">    <span class="keyword">if</span>((index &lt; <span class="number">0</span>) || (index &gt; a.length - <span class="number">1</span>)) fail(<span class="string">"Index value is out of bounds"</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> a[index];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> letters = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>];</div><div class="line">nth(letters, <span class="number">1</span>);</div><div class="line"><span class="comment">//=&gt; "b"</span></div><div class="line">nth(<span class="string">"abc"</span>, <span class="number">0</span>)</div><div class="line"><span class="comment">//=&gt; "a"</span></div><div class="line">nth(&#123;&#125;, <span class="number">0</span>)</div><div class="line"><span class="comment">//=&gt; Not supported on non-indexed type</span></div><div class="line">nth(letters, <span class="number">1000</span>)</div><div class="line"><span class="comment">//=&gt; Index value is out of bounds</span></div><div class="line">nth(letters, <span class="string">'aaa'</span>)</div><div class="line"><span class="comment">//=&gt; Expected a number as the index</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">second</span>(<span class="params">a</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> nth(a, <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line">second([<span class="string">'a'</span>,<span class="string">'b'</span>])</div><div class="line"><span class="comment">//=&gt; b</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">lameCSV</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.reduce(str.split(<span class="string">"\n"</span>),<span class="function"><span class="keyword">function</span>(<span class="params">table, row</span>) </span>&#123;</div><div class="line">        table.push(_.map(row.split(<span class="string">','</span>),<span class="function"><span class="keyword">function</span> (<span class="params">c</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> c.trim();</div><div class="line">        &#125;));</div><div class="line">        <span class="keyword">return</span> table;</div><div class="line">    &#125;, []);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectNames</span>(<span class="params">table</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.rest(_.map(table, _.first))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectAges</span>(<span class="params">table</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.rest(_.map(table, second));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectHairColor</span>(<span class="params">table</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.rest(_.map(table, <span class="function"><span class="keyword">function</span>(<span class="params">row</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> nth(row, <span class="number">2</span>);</div><div class="line">    &#125;));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> peopleTable = lameCSV(<span class="string">"name,age,hair\nMerble,35,red\nBob,64,blonde"</span>);</div><div class="line"><span class="comment">//=&gt; [["name","age","hair"],["Merble","35","red"],["Bob","64","blonde"]]</span></div><div class="line">selectNames(peopleTable);</div><div class="line"><span class="comment">//=&gt; ["Merble", "Bob"]</span></div><div class="line">selectAges(peopleTable);</div><div class="line"><span class="comment">//=&gt; ["35", "64"]</span></div><div class="line">selectHairColor(peopleTable);</div><div class="line"><span class="comment">//=&gt; ["red", "blonde"]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> mergeResults = _.zip;</div><div class="line">mergeResults(selectNames(peopleTable), selectAges(peopleTable));</div><div class="line"><span class="comment">//=&gt; [[Merble","35"],["Bob","64"]]</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">existy</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> x != <span class="literal">null</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">truthy</span>(<span class="params">x</span>)</span>&#123; <span class="keyword">return</span> (x != <span class="literal">false</span>) &amp;&amp; existy(x)&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doWhen</span>(<span class="params">cond, action</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(truthy(cond))&#123;</div><div class="line">        <span class="keyword">return</span> action();</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">undefined</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">executeIfHasField</span>(<span class="params">target, name</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> doWhen(existy(target[name]),<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> result = _.result(target, name);</div><div class="line">        <span class="built_in">console</span>.log(result);</div><div class="line">        <span class="built_in">console</span>.log([<span class="string">'The result is'</span>, result].join(<span class="string">' '</span>));</div><div class="line">        <span class="keyword">return</span> result;</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line">executeIfHasField([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="string">'reverse'</span>);</div><div class="line"><span class="comment">//=&gt; [3, 2, 1]</span></div><div class="line">executeIfHasField(&#123;foo: <span class="number">42</span>&#125;, <span class="string">'foo'</span>);</div><div class="line"><span class="comment">//=&gt; 42</span></div><div class="line">executeIfHasField([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], <span class="string">'notHere'</span>);</div><div class="line"><span class="comment">//=&gt; undefined</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">allOf</span>(<span class="params"><span class="comment">/* funs */</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.reduceRight(<span class="built_in">arguments</span>, <span class="function"><span class="keyword">function</span>(<span class="params">truth, f</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> truth &amp;&amp; f();</div><div class="line">    &#125;,<span class="literal">true</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">anyOf</span>(<span class="params"><span class="comment">/* funs */</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.reduceRight(<span class="built_in">arguments</span>, <span class="function"><span class="keyword">function</span>(<span class="params">truth, f</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> truth || f();</div><div class="line">    &#125;,<span class="literal">false</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">T</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line">allOf(T,T);</div><div class="line"><span class="comment">// =&gt;true</span></div><div class="line">anyOf(F,F,T,F);</div><div class="line"><span class="comment">// =&gt;true</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">cat</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> head = _.first(<span class="built_in">arguments</span>);</div><div class="line">    <span class="keyword">if</span>(existy(head))&#123;</div><div class="line">        <span class="keyword">return</span> head.concat.apply(head, _.rest(<span class="built_in">arguments</span>));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">construct</span>(<span class="params">head, tail</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> cat([head], _.toArray(tail))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapcat</span>(<span class="params">fun, coll</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> cat.apply(<span class="literal">null</span>, _.map(coll, fun));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">butlast</span>(<span class="params">coll</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.toArray(coll).slice(<span class="number">0</span>, <span class="number">-1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//平铺元素</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">interpose</span>(<span class="params">inter, coll</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> butlast(mapcat(<span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> construct(element, [inter])</div><div class="line">    &#125;,coll))</div><div class="line">&#125;</div><div class="line">interpose(<span class="string">","</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]);</div><div class="line"><span class="comment">//=&gt; [1, ",", 2, ",", 3, ",", 4]</span></div><div class="line"><span class="keyword">var</span> library = [&#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262010771"</span>, ed: <span class="number">1</span>&#125;, &#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262510871"</span>, ed: <span class="number">2</span>&#125;, &#123;title: <span class="string">"Joy of Clojure"</span>, isbn: <span class="string">"1935182641"</span>, ed: <span class="number">1</span>&#125;];</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">project</span>(<span class="params">table, keys</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.map(table, <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> _.pick.apply(<span class="literal">null</span>, construct(obj, keys));</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line"><span class="comment">//获取表特定的属性</span></div><div class="line"><span class="keyword">var</span> res = project(library,[ <span class="string">"title"</span>,<span class="string">"isbn"</span>]);</div><div class="line"><span class="comment">//=&gt; &#123;title: "SICP", isbn: "0262010771"&#125;, &#123;title: "SICP", isbn: "0262510871"&#125;, &#123;title: "Joy of Clojure", isbn: "1935182641"&#125;]</span></div><div class="line">_.pluck(res,<span class="string">"title"</span>);</div><div class="line"><span class="comment">//=&gt; ["SICP", "SICP", "Joy of Clojure"]</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//更改对象的键名(和sql里的 as 类似 SELECT ed AS edition FROM library)</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">rename</span>(<span class="params">obj, newNames</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.reduce(newNames, <span class="function"><span class="keyword">function</span>(<span class="params">o, nu, old</span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(_.has(obj, old))&#123;</div><div class="line">            o[nu] = obj[old];</div><div class="line">            <span class="keyword">return</span> o;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">return</span> o;</div><div class="line">        &#125;</div><div class="line">    &#125;,_.omit.apply(<span class="literal">null</span>, construct(obj, _.keys(newNames))))</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj = &#123;a: <span class="number">1</span>, b: <span class="number">2</span>&#125;;</div><div class="line"><span class="keyword">var</span> newNames = &#123;a: <span class="string">"AAA"</span>, b: <span class="string">"BBB"</span>&#125;;</div><div class="line"></div><div class="line">rename(obj,newNames);</div><div class="line"><span class="comment">//=&gt; &#123;AAA: 1, BBB: 2&#125;</span></div><div class="line"></div><div class="line"><span class="comment">//遍历对象数组</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">as</span>(<span class="params">table, newNames</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.map(table, <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> rename(obj, newNames);</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">as</span>(library, &#123;isbn:<span class="string">"ISBN"</span>&#125;);</div><div class="line"><span class="comment">//=&gt; [&#123;title: "SICP", ISBN: "0262010771", ed: 1&#125;, &#123;title: "SICP", ISBN: "0262510871", ed: 2&#125;, &#123;title: "Joy of Clojure", ISBN: "1935182641", ed: 1&#125;]</span></div><div class="line">project(<span class="keyword">as</span>(library, &#123;isbn:<span class="string">"ISBN"</span>&#125;),[<span class="string">"ISBN"</span>])</div><div class="line"><span class="comment">//=&gt; [&#123;ISBN: "0262010771"&#125;, &#123;ISBN: "0262510871"&#125;, &#123;ISBN: "1935182641"&#125;]</span></div></pre></td></tr></table></figure>
<h5 id="函数作用域"><a href="#函数作用域" class="headerlink" title="函数作用域"></a>函数作用域</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">strangerIdentity</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">this</span>[<span class="string">'i'</span>] = <span class="number">0</span>; <span class="keyword">this</span>[<span class="string">'i'</span>]&lt;n; <span class="keyword">this</span>[<span class="string">'i'</span>]++);</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>[<span class="string">'i'</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">strangerIdentity(<span class="number">108</span>);</div><div class="line"><span class="comment">//=&gt; 108</span></div><div class="line">i;</div><div class="line"><span class="comment">//=&gt; 108</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>[<span class="string">'a'</span>] = <span class="number">200</span>;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>[<span class="string">'a'</span>] + <span class="keyword">this</span>[<span class="string">'b'</span>];</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> globals = &#123;<span class="string">'b'</span>: <span class="number">2</span>&#125;;</div><div class="line">f.call(_.clone(globals));</div><div class="line">globals;</div><div class="line"><span class="comment">//=&gt; &#123;'b': 2&#125;</span></div><div class="line">a;</div><div class="line"><span class="comment">//=&gt; ReferenceError</span></div><div class="line">b;</div><div class="line"><span class="comment">//=&gt; ReferenceError</span></div></pre></td></tr></table></figure>
<h5 id="模拟闭包"><a href="#模拟闭包" class="headerlink" title="模拟闭包"></a>模拟闭包</h5><p>在经历了30年，闭包终于成为主流的变成语言的主要特点。<br>闭包犹如编程语言中的吸血鬼，他们捕获部下并给其永久的生命，知道自己被摧毁。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//局部变量</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">whatWasTheLocal</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> CAPTURED = <span class="string">'Oh hai'</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"The local was:"</span> + CAPTURED;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> reportLocal = whatWasTheLocal();</div><div class="line">reportLocal();</div><div class="line"><span class="comment">//=&gt; The local was:Oh hai</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//函数参数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createScaleFunction</span>(<span class="params">FACTOR</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> _.map(v,<span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> (n*FACTOR);</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> scale10 = createScaleFunction(<span class="number">10</span>);</div><div class="line">scale10([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);</div><div class="line"><span class="comment">//=&gt; [10, 20, 30]</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">captureShadow</span>(<span class="params">shadowed</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">shadowed</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> shadowed + <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> closureShadow = captureShadow(<span class="number">108</span>);</div><div class="line">closureShadow(<span class="number">2</span>);</div><div class="line"><span class="comment">//=&gt; 3</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">showObject</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(obj);</div><div class="line">        <span class="keyword">return</span> obj;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> o = &#123;a: <span class="number">42</span>&#125;;</div><div class="line"><span class="keyword">var</span> showO = showObject(o);</div><div class="line">showO();</div><div class="line"><span class="comment">//=&gt; &#123;a: 42&#125;</span></div><div class="line">o.xiao = <span class="string">"a"</span></div><div class="line">showO();</div><div class="line"><span class="comment">//=&gt; &#123;a: 42, xiao: "a"&#125;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//通过这种闭包模式提供访问保护是一个强大的技术，能使JavaScript程序员在应对软件复杂性时保持头脑清楚</span></div><div class="line"><span class="keyword">var</span> pingpong = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> private = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        inc: <span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> private += n;</div><div class="line">        &#125;,</div><div class="line">        dec: <span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> private -= n;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)()</div><div class="line">pingpong.inc(<span class="number">10</span>);</div><div class="line"><span class="comment">//=&gt; 10</span></div><div class="line">pingpong.dec(<span class="number">7</span>);</div><div class="line"><span class="comment">//=&gt; 3</span></div><div class="line"></div><div class="line">pingpong.div = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123; <span class="keyword">return</span> private/n &#125;;</div><div class="line">pingpong.div(<span class="number">3</span>);</div><div class="line"><span class="comment">//=&gt; ReferenceError: private is not defined</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//闭包的抽象</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">plucker</span>(<span class="params">field</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> (obj &amp;&amp; obj[field]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> best = &#123;title: <span class="string">"Infinite Jest"</span>, author: <span class="string">"DFW"</span>&#125;;</div><div class="line"><span class="keyword">var</span> getTitle = plucker(<span class="string">"title"</span>);</div><div class="line">getTitle(best);</div><div class="line"><span class="comment">//=&gt; Infinite Jest</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> books = [&#123;title: <span class="string">"Chthon"</span>&#125;, &#123;stars: <span class="number">5</span>&#125;, &#123;title: <span class="string">"Botchan"</span>&#125;];</div><div class="line"><span class="keyword">var</span> third = plucker(<span class="number">2</span>);</div><div class="line">third(books);</div><div class="line"><span class="comment">//=&gt; &#123;title: "Botchan"&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> library = [&#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262010771"</span>, ed: <span class="number">1</span>&#125;, &#123;title: <span class="string">"SICP"</span>, isbn: <span class="string">"0262510871"</span>, ed: <span class="number">2</span>&#125;, &#123;title: <span class="string">"Joy of Clojure"</span>, isbn: <span class="string">"1935182641"</span>, ed: <span class="number">1</span>&#125;];</div><div class="line">_.map(library, getTitle);</div><div class="line"><span class="comment">//=&gt; ["SICP", "SICP", "Joy of Clojure"]</span></div></pre></td></tr></table></figure>
<h5 id="以其他函数为参数的函数"><a href="#以其他函数为参数的函数" class="headerlink" title="以其他函数为参数的函数"></a>以其他函数为参数的函数</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">repeatedly</span>(<span class="params">times, fun</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.map(_.range(times), fun);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr = repeatedly(<span class="number">3</span>, <span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor((<span class="built_in">Math</span>.random()*<span class="number">10</span>))+<span class="number">1</span>;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">iterateUntil</span>(<span class="params">fun, check, init</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> ret = [];</div><div class="line">    <span class="keyword">var</span> result = fun(init);</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(check(result))&#123;</div><div class="line">        ret.push(result);</div><div class="line">        result = fun(result);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line">iterateUntil(<span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123; <span class="keyword">return</span> n+n &#125;,</div><div class="line">             <span class="function"><span class="keyword">function</span>(<span class="params">n</span>)</span>&#123; <span class="keyword">return</span> n&lt;= <span class="number">1024</span>&#125;,</div><div class="line">             <span class="number">1</span>);</div><div class="line"><span class="comment">//=&gt; [2, 4, 8, 16, 32, 64, 128, 256, 512, 1024]</span></div></pre></td></tr></table></figure>
<h5 id="高价函数"><a href="#高价函数" class="headerlink" title="高价函数"></a>高价函数</h5><p>解释闭包的关键点</p>
<ol>
<li>闭包会捕获一个值</li>
<li>每一个新的闭包都会捕获不一样的值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">//虽然直接对一个实例执行特定方法是完全合法的，</span></div><div class="line"><span class="comment">// 但函数式的风格更倾向于将调用对象作为参数。</span></div><div class="line"><span class="comment">// invoker会在一个对象不包含给定方法时返回undefined,</span></div><div class="line"><span class="comment">// 这样可以使用JavaScript天然的多态性构建多态函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">invoker</span>(<span class="params">name, method</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target <span class="comment">/* args */</span></span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(!existy(target)) fail(<span class="string">"Must provide a target"</span>);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> targetMethod = target[name];</div><div class="line">        <span class="keyword">var</span> args = _.rest(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> doWhen(existy(targetMethod) &amp;&amp; method === targetMethod,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> targetMethod.apply(target, args);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeUniqueStringFunction</span>(<span class="params">start</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> counter = start;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">prefix</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> [prefix, counter++].join(<span class="string">''</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> uniqueString = makeUniqueStringFunction(<span class="number">0</span>);</div><div class="line">uniqueString(<span class="string">"dari"</span>);</div><div class="line"><span class="comment">//=&gt; "dari0"</span></div><div class="line">uniqueString(<span class="string">"dars"</span>);</div><div class="line"><span class="comment">//=&gt; "dari1"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> omgenerator = (<span class="function"><span class="keyword">function</span>(<span class="params">init</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> counter = init;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        uniqueString: <span class="function"><span class="keyword">function</span>(<span class="params">prefix</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> [prefix, counter++].join(<span class="string">''</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;)(<span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(omgenerator.uniqueString(<span class="string">"dars"</span>));</div><div class="line"><span class="comment">//=&gt; dars0</span></div><div class="line"><span class="built_in">console</span>.log(omgenerator.uniqueString(<span class="string">"dars"</span>));</div><div class="line"><span class="comment">//=&gt; dars1</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fnull</span>(<span class="params">fun <span class="comment">/*, defaults  */</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> defaults = _.rest(<span class="built_in">arguments</span>);</div><div class="line">    <span class="built_in">console</span>.log(defaults);</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"><span class="comment">/* args */</span></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> args = _.first(<span class="built_in">arguments</span>,<span class="number">2</span>);</div><div class="line">        <span class="built_in">console</span>.log(args);</div><div class="line">        args = _.map(args, <span class="function"><span class="keyword">function</span>(<span class="params">e, i</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> existy(e) ? e : defaults[i];</div><div class="line">        &#125;);</div><div class="line">        <span class="comment">//console.log(args);</span></div><div class="line">        <span class="keyword">return</span> fun.apply(<span class="literal">null</span>,args);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> safeMult = fnull(<span class="function"><span class="keyword">function</span>(<span class="params">total, n</span>)</span>&#123; <span class="keyword">return</span> total * n &#125;, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line"><span class="keyword">var</span> nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="literal">null</span>,<span class="number">5</span>];</div><div class="line">_.reduce(nums, safeMult);</div><div class="line"><span class="comment">//=&gt; 30</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">defaults</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">o, k</span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> val = fnull(_.identity, d[k]);</div><div class="line">        <span class="keyword">return</span>  o &amp;&amp; val(o[k]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">config</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> lookup = defaults(&#123;critical: <span class="number">108</span>&#125;);</div><div class="line">    <span class="keyword">return</span> lookup(config, <span class="string">'critical'</span>);</div><div class="line">&#125;</div><div class="line">doSomething(&#123;critical: <span class="number">9</span>&#125;);</div><div class="line"><span class="comment">//=&gt; 9</span></div><div class="line">doSomething(&#123;&#125;);</div><div class="line"><span class="comment">//=&gt; 108</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checker</span>(<span class="params"><span class="comment">/* validators */</span></span>)</span>&#123;<span class="comment">//谓词函数</span></div><div class="line">    <span class="keyword">var</span> validators = _.toArray(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> _.reduce(validators, <span class="function"><span class="keyword">function</span>(<span class="params">errs, check</span>)</span>&#123;</div><div class="line">            <span class="keyword">if</span>(check(obj))&#123;</div><div class="line">                <span class="keyword">return</span> errs;</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">return</span> _.chain(errs).push(check.message).value();</div><div class="line">            &#125;</div><div class="line">        &#125;,[])</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">validator</span>(<span class="params">message, fun</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> f= <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> fun.apply(fun, <span class="built_in">arguments</span>);</div><div class="line">    &#125;;</div><div class="line">    f[<span class="string">'message'</span>] = message;</div><div class="line">    <span class="keyword">return</span> f;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">aMap</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> _.isObject(obj);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasKeys</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> keys = _.toArray(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">    <span class="keyword">var</span> fun = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> _.every(keys, <span class="function"><span class="keyword">function</span>(<span class="params">k</span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> _.has(obj, k);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">    fun.message = cat([<span class="string">"Must have values for keys:"</span>],keys).join(<span class="string">" "</span>);</div><div class="line">    <span class="keyword">return</span> fun;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> checkCommand = checker(validator(<span class="string">"must be a map"</span>, aMap));</div><div class="line"><span class="built_in">console</span>.log(checkCommand(&#123;&#125;));</div><div class="line"><span class="comment">//=&gt; []</span></div><div class="line"><span class="built_in">console</span>.log(checkCommand(<span class="number">100</span>));</div><div class="line"><span class="comment">//=&gt; ["must be a map"]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> checkCommand2 = checker(validator(<span class="string">"must be a map"</span>, aMap), hasKeys(<span class="string">'msg'</span>, <span class="string">'type'</span>));</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(checkCommand2(&#123;msg: <span class="string">"blash"</span>, type: <span class="string">"display"</span>&#125;));</div><div class="line"><span class="comment">//=&gt; []</span></div><div class="line"><span class="built_in">console</span>.log(checkCommand2(<span class="number">32</span>));</div><div class="line"><span class="comment">//=&gt; ["must be a map", "Must have values for keys: msg type"]</span></div><div class="line"><span class="built_in">console</span>.log(checkCommand2(&#123;&#125;));</div><div class="line"><span class="comment">//=&gt; ["Must have values for keys: msg type"]</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//虽然直接对一个实例执行特定方法是完全合法的，</span></div><div class="line"><span class="comment">// 但函数式的风格更倾向于将调用对象作为参数。</span></div><div class="line"><span class="comment">// invoker会在一个对象不包含给定方法时返回undefined,</span></div><div class="line"><span class="comment">// 这样可以使用JavaScript天然的多态性构建多态函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">invoker</span>(<span class="params">name, method</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target <span class="comment">/* args */</span></span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(!existy(target)) fail(<span class="string">"Must provide a target"</span>);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> targetMethod = target[name];</div><div class="line">        <span class="keyword">var</span> args = _.rest(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> doWhen(existy(targetMethod) &amp;&amp; method === targetMethod,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> targetMethod.apply(target, args);</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params"><span class="comment">/* funs */</span></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> funs = _.toArray(<span class="built_in">arguments</span>);</div><div class="line">    <span class="keyword">var</span> size = funs.length;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target <span class="comment">/*, args */</span></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> ret = <span class="literal">undefined</span>;</div><div class="line">        <span class="keyword">var</span> args = _.rest(_.toArray(<span class="built_in">arguments</span>));</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> funIndex = <span class="number">0</span>; funIndex &lt; size; funIndex++)&#123;</div><div class="line">            <span class="keyword">var</span> fun = funs[funIndex];</div><div class="line">            ret = fun.apply(fun, construct(target, args));</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(existy(ret)) <span class="keyword">return</span> ret;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> str = dispatch(invoker(<span class="string">'toString'</span>, <span class="built_in">Array</span>.prototype.toString), invoker(<span class="string">'toString'</span>, <span class="built_in">String</span>.prototype.toString));</div><div class="line"></div><div class="line">str(<span class="string">"abc"</span>);</div><div class="line"><span class="comment">//=&gt; abc</span></div><div class="line">str([<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]);</div><div class="line"><span class="comment">//=&gt; a,b,c</span></div><div class="line">str(&#123;&#125;);</div><div class="line"><span class="comment">//=&gt; undefined</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">stringReverse</span>(<span class="params">s</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!_.isString(s)) <span class="keyword">return</span> <span class="literal">undefined</span>;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> s.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> rev = dispatch(invoker(<span class="string">'reverse'</span>, <span class="built_in">Array</span>.prototype.reverse), stringReverse);</div><div class="line"></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(rev([<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]));</div><div class="line"><span class="comment">//= ["c", "b", "a"]</span></div><div class="line"><span class="built_in">console</span>.log(rev(<span class="string">"abc"</span>));</div><div class="line"><span class="comment">//=&gt; cba</span></div><div class="line"><span class="built_in">console</span>.log(rev(&#123;&#125;));</div><div class="line"><span class="comment">//=&gt; undefined</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">always</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> _.identity(x);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> sillyReverse = dispatch(rev,always(<span class="number">42</span>));</div><div class="line">sillyReverse([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);</div><div class="line"><span class="comment">//=&gt; [3, 2, 1]</span></div><div class="line">sillyReverse(<span class="string">"abc"</span>);</div><div class="line"><span class="comment">//=&gt; "cba"</span></div><div class="line">sillyReverse(<span class="number">1000</span>);</div><div class="line"><span class="comment">//=&gt; 42</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">performCommandHardcoded</span>(<span class="params">command</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> result;</div><div class="line"></div><div class="line">    <span class="keyword">switch</span> (command.type)&#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">'notify'</span>:</div><div class="line">            result = notify(command.message);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">'join'</span>:</div><div class="line">            result = changeView(command.target);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            alert(command.type);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isa</span>(<span class="params">type, action</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(type === obj.type)&#123;</div><div class="line">            <span class="keyword">return</span> action(obj);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> performCommand = dispatch(isa(<span class="string">'notify'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> notify(obj.message);</div><div class="line">&#125;),isa(<span class="string">'join'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> changeView(obj.target);</div><div class="line">&#125;),<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    alert(obj.type)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">var</span> performAdminCommand = dispatch(isa(<span class="string">'kill'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> shutdown(obj.hostname);</div><div class="line">&#125;),performCommand);</div><div class="line"><span class="keyword">var</span> performTrialUserCommand = dispatch(isa(<span class="string">'join'</span>,<span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">    alert(<span class="string">"Cannot join until approved"</span>);</div><div class="line">&#125;),performCommand);</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/20/JavaScript/functional programming/useful/" data-id="ciugro2xd0000wcniob6hqwer" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/function/">function</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/functional programming/First_class_citizen" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/15/JavaScript/functional programming/First_class_citizen/" class="article-date">
  <time datetime="2016-10-15T08:31:42.501Z" itemprop="datePublished">2016-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/15/JavaScript/functional programming/First_class_citizen/">函数是一等公民</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>当函数被看作“一等公民”时，那它就可以去任何值可以去的地方，很少有限制。比如数字在JavaScript里就是一等公民，同样作为一等公民的函数就会拥有类似数字的性质。</p>
</blockquote>
<h5 id="函数与数字一样可以储存为变量。"><a href="#函数与数字一样可以储存为变量。" class="headerlink" title="函数与数字一样可以储存为变量。"></a>函数与数字一样可以储存为变量。</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var fortytwo = function () &#123;</div><div class="line">     returnr 42;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h5 id="函数与数字一样可以储存为数组的一个元素"><a href="#函数与数字一样可以储存为数组的一个元素" class="headerlink" title="函数与数字一样可以储存为数组的一个元素"></a>函数与数字一样可以储存为数组的一个元素</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var fortytwos = [42, function()&#123; return 42;&#125;];</div></pre></td></tr></table></figure>
<h5 id="函数与数字一样可以作为对象的成员变量"><a href="#函数与数字一样可以作为对象的成员变量" class="headerlink" title="函数与数字一样可以作为对象的成员变量"></a>函数与数字一样可以作为对象的成员变量</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var fortytwos = &#123;number:42, fun: function () &#123;  return 42; &#125;&#125;;</div></pre></td></tr></table></figure>
<h5 id="函数与数字一样可以在使用时直接创建出来"><a href="#函数与数字一样可以在使用时直接创建出来" class="headerlink" title="函数与数字一样可以在使用时直接创建出来"></a>函数与数字一样可以在使用时直接创建出来</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">42 + (function()&#123; return 42;&#125;)();</div></pre></td></tr></table></figure>
<h5 id="函数与数字一样可以在使用时直接创建出来-1"><a href="#函数与数字一样可以在使用时直接创建出来-1" class="headerlink" title="函数与数字一样可以在使用时直接创建出来"></a>函数与数字一样可以在使用时直接创建出来</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">function weirdAdd(n,f)&#123; return n+f()&#125;;</div><div class="line"> weirdAdd(42,function()&#123; return 42;&#125;);</div></pre></td></tr></table></figure>
<h5 id="函数与数字一样可以被另一个函数返回"><a href="#函数与数字一样可以被另一个函数返回" class="headerlink" title="函数与数字一样可以被另一个函数返回"></a>函数与数字一样可以被另一个函数返回</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">return 42;</div><div class="line">return function()&#123;return 42;&#125;;</div></pre></td></tr></table></figure>
<blockquote>
<p>当我使用“函数”这个词的时候，指独立存在的函数，而“方法”，则指的是在对象的上下文中创建出来的函数。</p>
</blockquote>
<p>多种JavaScript编程方法</p>
<ol>
<li>命令式编程</li>
<li>基于原型的面向对象编程</li>
<li>元编程</li>
</ol>
<h5 id="Applicative编程-函数是编程处理函数功能很窄的一个方面"><a href="#Applicative编程-函数是编程处理函数功能很窄的一个方面" class="headerlink" title="Applicative编程(函数是编程处理函数功能很窄的一个方面)"></a>Applicative编程(函数是编程处理函数功能很窄的一个方面)</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">var nums= [1,2,3,4,5];</div><div class="line"></div><div class="line">function doubleAll(array)&#123;</div><div class="line">    return _.map(array, function(n)&#123; return n*2 &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">console.log(doubleAll(nums));</div><div class="line"></div><div class="line">function average(array)&#123;</div><div class="line">    var sum = _.reduce(array, function(a,b)&#123; return a+b &#125;);</div><div class="line">    return sum/ _.size(array);</div><div class="line">&#125;</div><div class="line"></div><div class="line">console.log(average(nums));</div><div class="line"></div><div class="line">function onlyEvent(array)&#123;</div><div class="line">    return _.filter(array, function(n)&#123;</div><div class="line">        return (n%2)=== 0;</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">console.log(onlyEvent(nums));</div><div class="line"></div><div class="line">function allOf(/* funs */)&#123;</div><div class="line">    return _.reduceRight(arguments, function(truth, f)&#123;</div><div class="line">        return truth &amp;&amp; f();</div><div class="line">    &#125;,true);</div><div class="line">&#125;</div><div class="line">function anyOf(/* funs */)&#123;</div><div class="line">    return _.reduceRight(arguments, function(truth, f)&#123;</div><div class="line">        return truth || f();</div><div class="line">    &#125;,false);</div><div class="line">&#125;</div><div class="line">function T()&#123;</div><div class="line">    return true;</div><div class="line">&#125;</div><div class="line">function F()&#123;</div><div class="line">    return false;</div><div class="line">&#125;</div><div class="line">allOf(T,T);</div><div class="line">anyOf(F,F,T,F);</div><div class="line"></div><div class="line">_.find([&apos;a&apos;,&apos;b&apos;,3,&apos;d&apos;],_.isNumber);</div><div class="line">//=&gt;3</div><div class="line">_.reject([&apos;a&apos;,&apos;b&apos;,3,&apos;d&apos;],_.isNumber;)</div><div class="line">//=&gt;[&apos;a&apos;,&apos;b&apos;,&apos;d&apos;]</div><div class="line">//下面的实现方式等价于reject</div><div class="line">function complement(pred)&#123;</div><div class="line">    return function()&#123;</div><div class="line">        return !pred.applay(null, _.toArray(arguments));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">_.filter([&apos;a&apos;,&apos;b&apos;,3,&apos;d&apos;],complement(_.isNumber))</div><div class="line"></div><div class="line">_.all([1,2,3,4], _.isNumber);</div><div class="line">_.any([1,2,&apos;c&apos;,4],_.isString);</div><div class="line"></div><div class="line">var people = [&#123;name:&quot;Rick&quot;,age:30&#125;,&#123;name:&quot;Jaka&quot;,age:24&#125;];</div><div class="line">    _.sortBy(people,function(p)&#123; return -p.age &#125;);</div><div class="line"></div><div class="line">_.groupBy _.countBy</div><div class="line">_.keys _.values</div><div class="line">_.pluck</div><div class="line">_.pairs</div><div class="line">_.object</div><div class="line">_.invert</div><div class="line">_.defaults</div><div class="line">_.omit</div><div class="line">_.pick</div></pre></td></tr></table></figure>
<h5 id="用100个函数操作一个数据结构，比用10个函数操作10个数据结构要好。"><a href="#用100个函数操作一个数据结构，比用10个函数操作10个数据结构要好。" class="headerlink" title="用100个函数操作一个数据结构，比用10个函数操作10个数据结构要好。"></a>用100个函数操作一个数据结构，比用10个函数操作10个数据结构要好。</h5>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/15/JavaScript/functional programming/First_class_citizen/" data-id="ciuarr5a20000zkni0y9wv3hz" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/function/">function</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/functional programming/Underscore_predicate_function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/10/15/JavaScript/functional programming/Underscore_predicate_function/" class="article-date">
  <time datetime="2016-10-15T06:59:26.781Z" itemprop="datePublished">2016-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Underscore/">Underscore</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/15/JavaScript/functional programming/Underscore_predicate_function/">谓词函数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>isNumber</li>
<li>isEqual</li>
<li>isEmpty</li>
<li>isElement</li>
<li>isArray</li>
<li>isObject</li>
<li>isArguments</li>
<li>isFunction</li>
<li>isString</li>
<li>isNumber</li>
<li>isFinite</li>
<li>isBoolean</li>
<li>isDate</li>
<li>isRegExp</li>
<li>isNaN</li>
<li>isNull</li>
<li>isUndefined</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/10/15/JavaScript/functional programming/Underscore_predicate_function/" data-id="ciugro2xl0001wcnim4mpp9vh" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/function/">function</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/24/JavaScript/function/" class="article-date">
  <time datetime="2016-09-24T03:36:55.964Z" itemprop="datePublished">2016-09-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/24/JavaScript/function/">常用合集</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="html"><a href="#html" class="headerlink" title="html"></a>html</h5><p><a href="#meta">meta</a></p>
<hr>
<h5 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h5><p><a href="#hasTouch">判断设备是否支持touch</a></p>
<hr>
<p></p><p id="meta">-</p><p></p>
<h5 id="常用meta"><a href="#常用meta" class="headerlink" title="常用meta"></a>常用meta</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=320"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,target-densitydpi=high-dpi,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"</span>/&gt;</span></div></pre></td></tr></table></figure>
<p></p><p id="hasTouch">-</p><p></p>
<h5 id="判断设备是否支持touch"><a href="#判断设备是否支持touch" class="headerlink" title="判断设备是否支持touch"></a>判断设备是否支持touch</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1</span></div><div class="line"><span class="keyword">var</span> hasTouch=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> touchObj=&#123;&#125;;</div><div class="line">	touchObj.isSupportTouch = <span class="string">"ontouchend"</span> <span class="keyword">in</span> <span class="built_in">document</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</div><div class="line">	touchObj.isEvent=touchObj.isSupportTouch?<span class="string">'touchstart'</span>:<span class="string">'click'</span>;</div><div class="line">	<span class="keyword">return</span> touchObj.isEvent;</div><div class="line">&#125;</div><div class="line"><span class="comment">//1</span></div><div class="line"><span class="keyword">var</span> hasTouch= <span class="string">"ontouchend"</span> <span class="keyword">in</span> <span class="built_in">document</span> ? <span class="literal">true</span> : <span class="literal">false</span>;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/24/JavaScript/function/" data-id="citfkkes50000roqkpgjiznho" class="article-share-link">Delen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript/theory" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/23/JavaScript/theory/" class="article-date">
  <time datetime="2016-09-23T03:59:22.869Z" itemprop="datePublished">2016-09-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/23/JavaScript/theory/">理论</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>使用一个函数来处理所有的事件的另一个原因是，它使定义手势的逻辑能够统一。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/23/JavaScript/theory/" data-id="citfkkest0003roqkuzlxe6lu" class="article-share-link">Delen</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-mobile/theory" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/22/mobile/theory/" class="article-date">
  <time datetime="2016-09-22T01:38:03.491Z" itemprop="datePublished">2016-09-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mobile/">mobile</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/22/mobile/theory/">手机端一些理论</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="循序渐进增强与手势"><a href="#循序渐进增强与手势" class="headerlink" title="循序渐进增强与手势"></a>循序渐进增强与手势</h5><blockquote>
<p>手势是伟大的，无需质疑。但他们并不总是可用的。所以最好是建立一套无需手势的界面来取代基于手势的界面，然后再将手势作为基本交互的增强。这种Web开发的方法被称为循序渐进增强。</p>
<p>循序渐进增强的最原始案例是在2003年被提出的。当时浏览器对css和javascript的支持不稳定。循序渐进增强被提出用来创建简单功能的HTML网站，css和JavaScript被建立在顶层来新增的功能。当先进的功能失效时，下面的一层是可用的。</p>
<p>在触摸界面，手势是顶层。首先应该有一个不依赖于手势就完全可用的javascript界面</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/22/mobile/theory/" data-id="citfkkesv0004roqkqbhigq42" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gesture/">gesture</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categorieën</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JSON/">JSON</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Underscore/">Underscore</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/animation/">animation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/events/">events</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/events/HTML-DOM-events/">HTML DOM events</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/mobile/">mobile</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/svg/">svg</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Labels</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Animation-performance/">Animation performance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Array/">Array</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Closures/">Closures</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Content-type/">Content-type</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DOMContentLoaded/">DOMContentLoaded</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Object-create/">Object.create</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ajax/">ajax</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation/">animation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/animation-library/">animation library</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/apply/">apply()</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bind/">bind()</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/call/">call()</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/clone/">clone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/concept/">concept</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/config/">config</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curry/">curry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/currying/">currying</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/function/">function</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gesture/">gesture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/library/">library</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/load/">load</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/onresize/">onresize</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/performance/">performance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/picture-compression/">picture compression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/polymorphism/">polymorphism</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/position/">position</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/prototype/">prototype</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/recursion/">recursion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scroll/">scroll</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/setTimeout/">setTimeout</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/style/">style</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/svg/">svg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tap/">tap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/transform/">transform</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/transition/">transition</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/uncurrying/">uncurrying</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Animation-performance/" style="font-size: 10px;">Animation performance</a> <a href="/tags/Array/" style="font-size: 10px;">Array</a> <a href="/tags/Closures/" style="font-size: 13.33px;">Closures</a> <a href="/tags/Content-type/" style="font-size: 10px;">Content-type</a> <a href="/tags/DOMContentLoaded/" style="font-size: 10px;">DOMContentLoaded</a> <a href="/tags/JSON/" style="font-size: 16.67px;">JSON</a> <a href="/tags/Object-create/" style="font-size: 10px;">Object.create</a> <a href="/tags/ajax/" style="font-size: 10px;">ajax</a> <a href="/tags/animation/" style="font-size: 16.67px;">animation</a> <a href="/tags/animation-library/" style="font-size: 10px;">animation library</a> <a href="/tags/apply/" style="font-size: 13.33px;">apply()</a> <a href="/tags/bind/" style="font-size: 13.33px;">bind()</a> <a href="/tags/call/" style="font-size: 13.33px;">call()</a> <a href="/tags/clone/" style="font-size: 10px;">clone</a> <a href="/tags/concept/" style="font-size: 10px;">concept</a> <a href="/tags/config/" style="font-size: 10px;">config</a> <a href="/tags/curry/" style="font-size: 10px;">curry</a> <a href="/tags/currying/" style="font-size: 10px;">currying</a> <a href="/tags/function/" style="font-size: 20px;">function</a> <a href="/tags/gesture/" style="font-size: 10px;">gesture</a> <a href="/tags/library/" style="font-size: 10px;">library</a> <a href="/tags/load/" style="font-size: 10px;">load</a> <a href="/tags/onresize/" style="font-size: 10px;">onresize</a> <a href="/tags/performance/" style="font-size: 10px;">performance</a> <a href="/tags/picture-compression/" style="font-size: 10px;">picture compression</a> <a href="/tags/polymorphism/" style="font-size: 10px;">polymorphism</a> <a href="/tags/position/" style="font-size: 10px;">position</a> <a href="/tags/prototype/" style="font-size: 10px;">prototype</a> <a href="/tags/recursion/" style="font-size: 10px;">recursion</a> <a href="/tags/scroll/" style="font-size: 10px;">scroll</a> <a href="/tags/setTimeout/" style="font-size: 10px;">setTimeout</a> <a href="/tags/style/" style="font-size: 10px;">style</a> <a href="/tags/svg/" style="font-size: 10px;">svg</a> <a href="/tags/tap/" style="font-size: 10px;">tap</a> <a href="/tags/transform/" style="font-size: 13.33px;">transform</a> <a href="/tags/transition/" style="font-size: 10px;">transition</a> <a href="/tags/uncurrying/" style="font-size: 10px;">uncurrying</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archieven</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recente berichten</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/10/27/JavaScript/functional programming/purity/">纯度</a>
          </li>
        
          <li>
            <a href="/2016/10/25/JavaScript/functional programming/recursion/">递归</a>
          </li>
        
          <li>
            <a href="/2016/10/24/JavaScript/functional programming/Underscore_node/">Underscore.js笔记</a>
          </li>
        
          <li>
            <a href="/2016/10/22/JavaScript/functional programming/curry/">柯里化</a>
          </li>
        
          <li>
            <a href="/2016/10/20/JavaScript/functional programming/useful/">常用函数</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 shanyang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//cdn.bootcss.com/jquery/1.11.0/jquery.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>